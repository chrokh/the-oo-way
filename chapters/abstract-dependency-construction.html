
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>74. Abstract dependency construction &#8212; The Object Oriented Way</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="75. Abstract dependency injection" href="abstract-dependency-injection.html" />
    <link rel="prev" title="73. Type conversions (of objects)" href="object-type-conversions.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-V69WNXD095"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-V69WNXD095');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">The Object Oriented Way</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="sets.html">
   1. 🟢 Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions.html">
   2. 🟢 Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="algorithms.html">
   3. 🟠 Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="computation.html">
   4. 🟠 Computation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="terminals.html">
   5. Terminals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="syntax.html">
   6. 🟢 Syntax
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="semantics.html">
   7. 🟢 Semantics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="compilation.html">
   8. 🟢 Compilation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="execution.html">
   9. 🟢 Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interpretation.html">
   10. 🟢 Interpretation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="errors.html">
   11. 🟢 Errors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="documentation.html">
   12. Documentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="comments.html">
   13. 🟢 Comments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="standard-out.html">
   14. Standard out
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="values.html">
   15. 🟢 Values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="variables.html">
   16. 🟢 Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="standard-in.html">
   17. Standard in
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indentation.html">
   18. Indentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="statements.html">
   19. Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="expressions.html">
   20. Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="operators.html">
   21. Operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-types.html">
   22. 🟢 Data types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="selection.html">
   23. Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="paradigms.html">
   24. Paradigms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-conversions.html">
   25. Type conversions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-checking.html">
   26. 🟢 Type-checking
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-systems.html">
   27. 🟢 Type systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nothingness.html">
   28. 🟢 Nothingness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-hierarchies.html">
   29. Type hierarchies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="abstraction.html">
   30. Abstraction / Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indirection.html">
   31. Indirection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="business-logic.html">
   32. Business logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="debugging.html">
   33. Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arrays.html">
   34. Arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="syntactic-sugar.html">
   35. Syntactic sugar
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iteration.html">
   36. Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="command-line-arguments.html">
   37. Command line arguments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mutability.html">
   38. Mutability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-testing.html">
   39. Type testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="value-and-reference-semantics.html">
   40. Value and reference semantics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simple-types.html">
   41. Simple types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="static-methods.html">
   42. Static methods (procedures)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="purity.html">
   43. Purity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="static-classes.html">
   44. Static classes (Modules)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-structures.html">
   45. Data structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="composition.html">
   46. Composition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="overloading.html">
   47. Overloading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="recursion.html">
   48. Recursion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="scope.html">
   49. Scope
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="namespaces.html">
   50. Namespaces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="basic-exceptions.html">
   51. Exceptions (part 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stack-traces.html">
   52. Stack traces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pillars.html">
   53. Pillars
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="objects.html">
   54. 🟠 Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classes.html">
   55. Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fields.html">
   56. Fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="constructors.html">
   57. Constructors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="instance-methods.html">
   58. 🟠 Instance methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-signatures.html">
   59. Type signatures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="instance-variables.html">
   60. Instance variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="basic-access-modifiers.html">
   61. Access modifiers (basic).
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="properties.html">
   62. Properties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="object-composition.html">
   63. 🟢 Object composition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="concrete-dependency-construction.html">
   64. 🟢 Concrete dependency construction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="concrete-dependency-injection.html">
   65. 🟢 Concrete dependency injection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="immutable-objects.html">
   66. Immutable objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interfaces.html">
   67. 🟢 Interfaces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="subtype-polymorphism.html">
   68. 🟢 Subtype polymorphism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inheritance.html">
   69. Inheritance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="overriding.html">
   70. Overriding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hiding.html">
   71. Hiding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="advanced-access-modifiers.html">
   72. Access modifiers (advanced)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="object-type-conversions.html">
   73. Type conversions (of objects)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   74. 🟢 Abstract dependency construction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="abstract-dependency-injection.html">
   75. 🟠 Abstract dependency injection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="advanced-exceptions.html">
   76. Advanced exceptions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prototypes.html">
   77. Prototypes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="base-class-library.html">
   78. Base class library
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="boxing.html">
   79. Boxing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="structure-types.html">
   80. Structure types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="anonymous-types.html">
   81. Anonymous types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="generics.html">
   82. Generics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="variance.html">
   83. Variance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="business-objects.html">
   84. Business objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="requirements.html">
   85. Requirements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="correctness.html">
   86. Correctness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="maintainability.html">
   87. Maintainability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code-smells.html">
   88. Code smells and anti-patterns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coupling.html">
   89. Coupling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cohesion.html">
   90. Cohesion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="refactoring.html">
   91. Refactoring
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="design-principles.html">
   92. Design principles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="single-responsibility-principle.html">
   93. Single responsibility principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interface-segregation-principle.html">
   94. Interface segregation principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="deep-classes.html">
   95. Deep classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="types-over-tests.html">
   96. Types over tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="define-errors-out-of-existence.html">
   97. Define errors out of existence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="liskov-substitution-principle.html">
   98. 🟠 Liskov Substitution Principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="open-closed-principle.html">
   99. Open-closed principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dependency-inversion-principle.html">
   100. Dependency inversion principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="composition-over-inheritance.html">
   101. Composition over inheritance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="documentation-driven-development.html">
   102. Documentation-driven development
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="design-patterns.html">
   103. Design patterns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="strategy-pattern.html">
   104. 🟠 Strategy pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="delegates.html">
   105. Delegates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="extension-methods.html">
   106. Extension methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="null-object-pattern.html">
   107. 🟠 Null object pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="observer-pattern.html">
   108. 🟠 Observer pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="events.html">
   109. Events
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="adapter-pattern.html">
   110. 🟠 Adapter pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bridge-pattern.html">
   111. 🟠 Bridge pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="factory-method-pattern.html">
   112. 🟠 Factory method pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="composite-pattern.html">
   113. 🟠 Composite pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="state-pattern.html">
   114. 🟠 State pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lambdas.html">
   115. Lambdas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iterator-pattern.html">
   116. 🟠 Iterator pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="enumerators.html">
   117. Enumerators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexers.html">
   118. Indexers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linq.html">
   119. LINQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="visitor-pattern.html">
   120. Visitor pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pattern-matching.html">
   121. Pattern matching
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="streams.html">
   122. Streams
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reading.html">
   123. Suggested reading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   124. Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/chrokh/the-oo-way/issues/new?title=Issue%20on%20page%20%2Fchapters/abstract-dependency-construction.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapters/abstract-dependency-construction.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finding-an-abstraction">
   74.1. Finding an abstraction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#composing-the-abstraction">
   74.2. Composing the abstraction
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Abstract dependency construction</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finding-an-abstraction">
   74.1. Finding an abstraction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#composing-the-abstraction">
   74.2. Composing the abstraction
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="abstract-dependency-construction">
<h1><span class="section-number">74. </span>Abstract dependency construction<a class="headerlink" href="#abstract-dependency-construction" title="Permalink to this headline">#</a></h1>
<p>Remember the four types of <a class="reference internal" href="object-composition.html"><span class="doc std std-doc">object composition</span></a> summarized by the quadrant diagram of abstraction levels in object composition (<a class="reference internal" href="object-composition.html#fig-object-composition-object-diagram"><span class="std std-numref">Fig. 63.1</span></a>).
We’ve already talked about <em>concrete</em> dependency <a class="reference internal" href="#"><span class="doc std std-doc">construction</span></a> and <a class="reference internal" href="concrete-dependency-injection.html"><span class="doc std std-doc">injection</span></a>.
However, since we’ve now also learned about <span class="xref myst">subtyping</span> we’re ready to talk about <em>abstract</em> dependency <a class="reference internal" href="#"><span class="doc std std-doc">construction</span></a> and <a class="reference internal" href="abstract-dependency-injection.html"><span class="doc std std-doc">injection</span></a>.
In this chapter we’ll take a quick look at abstract dependency construction.</p>
<p>In truth, there isn’t much to say about abstract dependency construction.
Let’s start with the code we built in the end of the chapter on <a class="reference internal" href="concrete-dependency-construction.html"><span class="doc std std-doc">concrete dependency construction</span></a>.
We had a class called <code class="docutils literal notranslate"><span class="pre">RobbersStringCipher</span></code> that exposed a method called <code class="docutils literal notranslate"><span class="pre">Encode</span></code> that took a <code class="docutils literal notranslate"><span class="pre">string</span></code> as input and produced a <code class="docutils literal notranslate"><span class="pre">string</span></code> as output.
This method in turn instantiated and delegated to an instance of <code class="docutils literal notranslate"><span class="pre">RobbersCharCipher</span></code>.
The method it delegated to was also called <code class="docutils literal notranslate"><span class="pre">Encode</span></code> but this method took a <code class="docutils literal notranslate"><span class="pre">char</span></code> as input and produced a <code class="docutils literal notranslate"><span class="pre">string</span></code> as output.
Together it all looked like the code below:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RobbersStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">RobbersCharCipher</span><span class="w"> </span><span class="n">charCipher</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">RobbersStringCipher</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">vowel</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">charCipher</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RobbersCharCipher</span><span class="p">(</span><span class="n">vowel</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">output</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">charCipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">c</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">class</span><span class="w"> </span><span class="nc">RobbersCharCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">vowel</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">RobbersCharCipher</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">vowel</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">vowel</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vowel</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">consonants</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;bcdfghjklmnpqrstvwxz&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">consonants</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">Char</span><span class="p">.</span><span class="n">ToLower</span><span class="p">(</span><span class="n">input</span><span class="p">))</span><span class="w"> </span><span class="p">!=</span><span class="w"> </span><span class="p">-</span><span class="m">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s">$&quot;{input}{vowel}{input}&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Now that we’ve learned about subtype polymorphism we should have our abstraction goggles on and constantly look for commonalities between types that would lend themselves to a new abstraction.
Remember Leetspeak?
Have a look at the following code:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">LeetStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">LeetCharCipher</span><span class="w"> </span><span class="n">charCipher</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LeetCharCipher</span><span class="p">();</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">output</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">charCipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">c</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">class</span><span class="w"> </span><span class="nc">LeetCharCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;4&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;A&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;L&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;7&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;7&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;L&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;E&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;3&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;3&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;E&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;O&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;O&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">default</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Starting to see where this is going?
Have a close look at <code class="docutils literal notranslate"><span class="pre">RobbersStringCipher</span></code> and <code class="docutils literal notranslate"><span class="pre">LeetStringCipher</span></code>.
They are eerily similar, are they not?
How about <code class="docutils literal notranslate"><span class="pre">RobbersCharCipher</span></code> and <code class="docutils literal notranslate"><span class="pre">LeetCharCipher</span></code>?
They too are similar.
Of course, this whole example is orchestrated by me so that these similarities emerge.
However, you will often find that if you think about your domain model long and hard enough then you will find a way to make similarities, and hence abstractions, emerge.</p>
<p>Remember the code you wrote in <a class="reference internal" href="concrete-dependency-construction.html#ex:concrete-dependency-construction-caesar-cipher"><span class="std std-numref">Exercise 64.1</span></a> where we implemented a Caesar Cipher by again decomposing the problem into the idea of encoding a full string and decoding a single character.
You ought to have ended up with two classes that also are eerily similar to the two string and <code class="docutils literal notranslate"><span class="pre">char</span></code> cipher classes here.</p>
<p>We’ve already talked about how we can unify different ciphers that take a <code class="docutils literal notranslate"><span class="pre">string</span></code> as input and produce a <code class="docutils literal notranslate"><span class="pre">string</span></code> as output under the interface <code class="docutils literal notranslate"><span class="pre">ICipher</span></code> in the chapter on <a class="reference internal" href="subtype-polymorphism.html#subtype-polymorphism"><span class="std std-ref">subtype polymorphism</span></a>.
Let’s ignore the <code class="docutils literal notranslate"><span class="pre">string</span></code> ciphers in this chapter and instead focus on the <code class="docutils literal notranslate"><span class="pre">char</span></code> ciphers.</p>
<p>All the <code class="docutils literal notranslate"><span class="pre">char</span></code> ciphers have a method called <code class="docutils literal notranslate"><span class="pre">Encode</span></code> which takes a <code class="docutils literal notranslate"><span class="pre">char</span></code> as input and produces a <code class="docutils literal notranslate"><span class="pre">string</span></code> as output.
Let’s put that in an interface.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">ICharCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Ok, implementing that interface should be straightforward since we wrote the interface based on a method that already existed in both <code class="docutils literal notranslate"><span class="pre">RobbersCharCipher</span></code> and <code class="docutils literal notranslate"><span class="pre">LeetCharCipher</span></code>.
So let’s just declare that these two classes are implementing the interface <code class="docutils literal notranslate"><span class="pre">ICharCipher</span></code> and make sure that our code compiles.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RobbersCharCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharCipher</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="k">class</span><span class="w"> </span><span class="nc">LeetCharCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharCipher</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">Build succeeded.</span>
</pre></div>
</div>
<p>Ok, but what does the common interface <code class="docutils literal notranslate"><span class="pre">ICharCipher</span></code> enable us to do?
Sure, we could redefine the lines that declare the variable <code class="docutils literal notranslate"><span class="pre">charCipher</span></code> in both <code class="docutils literal notranslate"><span class="pre">RobbersStringCipher</span></code> and <code class="docutils literal notranslate"><span class="pre">LeetStringCipher</span></code> so that the compile-time type is the abstraction <code class="docutils literal notranslate"><span class="pre">ICharCipher</span></code> rather than any concrete implementation of that interface.
We would take this code:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RobbersStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">RobbersCharCipher</span><span class="w"> </span><span class="n">charCipher</span><span class="p">;</span><span class="w"></span>
<span class="c1">// ...</span>
</pre></div>
</div>
<p>and change it to this:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RobbersStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">ICharCipher</span><span class="w"> </span><span class="n">charCipher</span><span class="p">;</span><span class="w"></span>
<span class="c1">// ...</span>
</pre></div>
</div>
<p>But do we really gain anything substantial from this?
Not really.
If you’ve got code where you’re somehow switching between different ciphers in the same object over time then it’s possible to gain something from this but probably not.
In our case, there’s really no obvious benefit.</p>
<section id="finding-an-abstraction">
<h2><span class="section-number">74.1. </span>Finding an abstraction<a class="headerlink" href="#finding-an-abstraction" title="Permalink to this headline">#</a></h2>
<p>However, what if we could get rid of the duplicated code in the <code class="docutils literal notranslate"><span class="pre">Encode</span></code> methods of the <code class="docutils literal notranslate"><span class="pre">string</span></code> ciphers.
That would be useful.
We have already learned the design principle abbreviated DRY, which stands for “Don’t Repeat Yourself”.
As we will learn later, duplicated code is also considered a <span class="xref myst">code smell</span>.</p>
<p>Notice how <em>almost all the variation</em> between the ciphers in this chapter occurr in the <code class="docutils literal notranslate"><span class="pre">char</span></code> ciphers, not in the <code class="docutils literal notranslate"><span class="pre">string</span></code> ciphers.
Ignoring parameterization of constructors for now, we conclude that the <em>only</em> difference between <code class="docutils literal notranslate"><span class="pre">RobbersStringCipher</span></code> and <code class="docutils literal notranslate"><span class="pre">LeetStringCipher</span></code> is what <em>type</em> of <code class="docutils literal notranslate"><span class="pre">char</span></code> cipher they happen to instantiate and thus delegate to.</p>
<p>So let’s think about this.
If there’s nothing that’s different between <code class="docutils literal notranslate"><span class="pre">RobbersStringCipher</span></code> and <code class="docutils literal notranslate"><span class="pre">LeetStringCipher</span></code>, then what is the concept that makes them the same.
Think about it, they both encode in the same way.
One character at a time.</p>
<p>To see similarities, we must sometimes look at differences.
Remember the reverse cipher?
Here’s an implementation of the reverse cipher:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ReverseCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">=</span><span class="n">input</span><span class="p">.</span><span class="n">Length</span><span class="p">-</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">&gt;=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="p">--)</span><span class="w"></span>
<span class="w">      </span><span class="n">output</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Notice how we’re picking characters from the input string “backwards” but we’re building the encoded string “forwards”.
In other words we’re taking characters last to first but we’re building the resulting string first to last.</p>
<p>The Reverse cipher algorithm is fundamentally different from the Robber’s cipher and Leetspeak.
In the sense that it cannot (easily) be implemented as a left-to-right character-by-character conversion.
The first character of the input <code class="docutils literal notranslate"><span class="pre">string</span></code> <em>cannot</em> be used as input to create the first chunk of the output <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p>
<p>So, what’s one thing that unifies the Robber’s cipher and Leetspeak?
The encoding algorithms can both be implemented as character-by-character conversions where every input character yields one or more output characters in the correct order.</p>
<div class="exercise admonition" id="ex:char-wise-cipher-description">

<p class="admonition-title"><span class="caption-number">Exercise 74.1 </span></p>
<section id="exercise-content">
<p>Describe another conversion algorithm that can be implemented as a character-wise conversion.
Meaning that it could be a subclass of <code class="docutils literal notranslate"><span class="pre">CharWiseCipher</span></code>.</p>
</section>
</div>
</section>
<section id="composing-the-abstraction">
<h2><span class="section-number">74.2. </span>Composing the abstraction<a class="headerlink" href="#composing-the-abstraction" title="Permalink to this headline">#</a></h2>
<p>So how do we implement this?
In this chapter we’ll use <a class="reference internal" href="inheritance.html#inheritance"><span class="std std-ref">inheritance</span></a> but in the chapter on <a class="reference internal" href="abstract-dependency-injection.html"><span class="doc std std-doc">abstract dependency injection</span></a> we’ll use composition instead.
Most, including myself, would argue that the composition based solution is superior.
If you’ve ever heard about the design principle <a class="reference internal" href="composition-over-inheritance.html"><span class="doc std std-doc">composition over inheritance</span></a> you will soon start to see why this principle exists.
At it’s core, the problem with inheritance is that it assumes that you problem forms a hierarchy.
Few problems are hierarchies, many are graphs.
But, let’s go with inheritance in this chapter since we’re talking about abstract dependency <em>construction</em> and not <em>injection</em>.</p>
<p>What we can do with inheritance is that we can say that the method <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">Encode</span> <span class="pre">(string</span> <span class="pre">input)</span></code> should be implemented in a baseclass from which other subclasses can inherit.
That method then delegates to a <a class="reference internal" href="advanced-access-modifiers.html"><span class="doc std std-doc">protected</span></a> instance variable which can be overwritten upon construction of subclasses.
Let’s look at some code to make sense of this.
Here’s the base class:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CharWiseCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">protected</span><span class="w"> </span><span class="n">ICharCipher</span><span class="w"> </span><span class="n">charCipher</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IdentityCharCipher</span><span class="p">();</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">output</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">charCipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">c</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>What does this baseclass do?
Two things:</p>
<ol class="simple">
<li><p>It declares and initializes the <code class="docutils literal notranslate"><span class="pre">protected</span></code> instance variable <code class="docutils literal notranslate"><span class="pre">charCipher</span></code> to a default value.</p></li>
<li><p>It declares and implements the instance method <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">Encode</span> <span class="pre">(string</span> <span class="pre">input)</span></code> as simply passing each character of the <code class="docutils literal notranslate"><span class="pre">string</span></code> to the <code class="docutils literal notranslate"><span class="pre">Encode</span></code> method of <code class="docutils literal notranslate"><span class="pre">charCipher</span></code> and concatenating the result.</p></li>
</ol>
<p>But what is the type <code class="docutils literal notranslate"><span class="pre">IdentityCharCipher</span></code> that acts as the default value?
Well, we’ve talked about the idea of identity functions and values before.
The identity <code class="docutils literal notranslate"><span class="pre">char</span></code> cipher is a cipher that simply returns whatever you pass it back.
As you might have suspected, the class <code class="docutils literal notranslate"><span class="pre">IdentityCharCipher</span></code> is implemented something like this:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">IdentityCharCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Let’s now look at how the baseclass <code class="docutils literal notranslate"><span class="pre">CharWiseCipher</span></code> behaves before we move on.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CharWiseCipher</span><span class="p">().</span><span class="n">Encode</span><span class="p">(</span><span class="s">&quot;Hello world&quot;</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">Hello world</span>
</pre></div>
</div>
<p>Simple, and pretty pointless so far.
But, we can now create subclasses for each of our character-wise ciphers.
Each of the subclasses must, upon construction, replace the <code class="docutils literal notranslate"><span class="pre">protected</span></code> instance variable <code class="docutils literal notranslate"><span class="pre">charCipher</span></code> that’s declared in the base class with whatever concrete <code class="docutils literal notranslate"><span class="pre">ICharCipher</span></code> that they need.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">LeetCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">CharWiseCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">LeetCipher</span><span class="w"> </span><span class="p">()</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">charCipher</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LeetCharCipher</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">class</span><span class="w"> </span><span class="nc">RobbersCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">CharWiseCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">RobbersCipher</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">vowel</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">charCipher</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RobbersCharCipher</span><span class="p">(</span><span class="n">vowel</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Notice how utterly simple both of these ciphers now are.
They almost don’t contain any code at all.
This is the power of abstraction and composition.
By building abstract building blocks we can trivially compose them to solve complex problems.</p>
<p>Notice how the constructor of <code class="docutils literal notranslate"><span class="pre">RobbersCipher</span></code> can remain parameterized and thus still pass the parameter on to the constructor of <code class="docutils literal notranslate"><span class="pre">RobbersCharCipher</span></code>.
However, perhaps you remember that we, in the chapter on <a class="reference internal" href="concrete-dependency-construction.html"><span class="doc std std-doc">concrete dependency construction</span></a> cautioned that this need to pass constructor values down from type to type is a symptom of which dependency <em>construction</em> is the cause.
When we move to dependency <em>injection</em> this need to enable passing of constructor parameters simply goes away.</p>
<p>For an overview of the code that we’ve built in this chapter, have a look at <a class="reference internal" href="#fig-abstract-dependency-construction-uml"><span class="std std-numref">Fig. 74.1</span></a>.</p>
<figure class="align-default" id="fig-abstract-dependency-construction-uml">
<img alt="https://via.placeholder.com/500x275?text=Image+coming+soon" src="https://via.placeholder.com/500x275?text=Image+coming+soon" />
<figcaption>
<p><span class="caption-number">Fig. 74.1 </span><span class="caption-text">UML class diagram of our example of abstract dependency construction.</span><a class="headerlink" href="#fig-abstract-dependency-construction-uml" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Isn’t all this a bit overkill you might ask?
No, this is just the beginning.
The point is that now other ciphers that take a full <code class="docutils literal notranslate"><span class="pre">string</span></code> as input and performs their transformation one character at a time from left to right can subclass <code class="docutils literal notranslate"><span class="pre">CharWiseCipher</span></code> and simply, upon construction, set the instance variable to an instance that’s suitable for whatever we’re trying to achieve with that particular cipher.</p>
<p>This means that the <code class="docutils literal notranslate"><span class="pre">LeetStringCipher</span></code> which we’ve now renamed to <code class="docutils literal notranslate"><span class="pre">LeetCipher</span></code> and the <code class="docutils literal notranslate"><span class="pre">RobbersStringCipher</span></code> which we’ve now renamed to simply <code class="docutils literal notranslate"><span class="pre">RobbersCipher</span></code> can become utterly trivial.</p>
<div class="exercise admonition" id="chapters/abstract-dependency-construction-exercise-1">

<p class="admonition-title"><span class="caption-number">Exercise 74.2 </span></p>
<section id="exercise-content">
<p>Implement the algorithm you described in <a class="reference internal" href="#ex:char-wise-cipher-description"><span class="std std-numref">Exercise 74.1</span></a> as a subclass of <code class="docutils literal notranslate"><span class="pre">CharWiseCipher</span></code>.</p>
</section>
</div>
<div class="exercise admonition" id="chapters/abstract-dependency-construction-exercise-2">

<p class="admonition-title"><span class="caption-number">Exercise 74.3 </span></p>
<section id="exercise-content">
<p>Is it sensible to make the Reverse cipher a subclass of <code class="docutils literal notranslate"><span class="pre">CharWiseCipher</span></code>?
Why or why not?</p>
</section>
</div>
<div class="exercise admonition" id="chapters/abstract-dependency-construction-exercise-3">

<p class="admonition-title"><span class="caption-number">Exercise 74.4 </span></p>
<section id="exercise-content">
<p>What is the difference between <em>concrete</em> dependency construction and <em>abstract</em> dependency construction?</p>
</section>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="object-type-conversions.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">73. </span>Type conversions (of objects)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="abstract-dependency-injection.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">75. </span>Abstract dependency injection</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Christopher Okhravi<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>