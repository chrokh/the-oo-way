
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>68. Abstract injected object composition &#8212; The Object Oriented Way (DRAFT)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="69. Variance" href="variance.html" />
    <link rel="prev" title="67. Abstract constructed object composition" href="abstract-constructed-object-composition.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-V69WNXD095"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-V69WNXD095');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">The Object Oriented Way (DRAFT)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fundamentals
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="sets.html">
   1. ★ Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions.html">
   2. ★ Functions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Terminals
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="terminals.html">
   3. Terminals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="standard-out.html">
   4. Standard out
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="standard-in.html">
   5. Standard in
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Computation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="algorithms.html">
   6. ★ Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="computation.html">
   7. ★ Computation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="syntax.html">
   8. ★ Syntax
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="semantics.html">
   9. ★ Semantics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="compilation.html">
   10. ★ Compilation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="execution.html">
   11. ★ Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interpretation.html">
   12. ★ Interpretation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="errors.html">
   13. ★ Errors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="comments.html">
   14. ★ Comments
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Values
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="values.html">
   15. ★ Values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="variables.html">
   16. ★ Variables
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statements &amp; expressions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="statements.html">
   17. Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="expressions.html">
   18. Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="operators.html">
   19. Operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="paradigms.html">
   20. Paradigms
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data types
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="data-types.html">
   21. ★ Data types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-conversions.html">
   22. Type conversions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-checking.html">
   23. ★ Type-checking
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-systems.html">
   24. ★ Type systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-hierarchies.html">
   25. Type hierarchies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-testing.html">
   26. Type testing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basic types
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="simple-types.html">
   27. Simple types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="enums.html">
   28. Enums
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="value-tuples.html">
   29. Value tuples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arrays.html">
   30. Arrays
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Control flow
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="selection.html">
   31. ★ Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iteration.html">
   32. ★ Iteration
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Input/output
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="command-line-arguments.html">
   33. Command line arguments
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Mutability
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mutability.html">
   34. Mutability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="immutable-objects.html">
   35. Immutable objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="value-and-reference-semantics.html">
   36. Value and reference semantics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Nothingness
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="nothingness.html">
   37. ★ Nothingness
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Procedures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="methods.html">
   38. ★ Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="method-composition.html">
   39. Method composition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="static-classes.html">
   40. Static classes (Modules)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="static-methods.html">
   41. ★ Static methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="purity.html">
   42. Purity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="overloading.html">
   43. ★ Overloading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="recursion.html">
   44. Recursion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modules
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="data-structures.html">
   45. Data structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="scope.html">
   46. Scope
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="namespaces.html">
   47. Namespaces
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exceptions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="basic-exceptions.html">
   48. Exceptions (part 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stack-traces.html">
   49. Stack traces
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Objects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="objects.html">
   50. ★ Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classes.html">
   51. ★ Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fields.html">
   52. ★ Fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="constructors.html">
   53. ★ Constructors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="instance-methods.html">
   54. ★ Instance methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="properties.html">
   55. ★ Properties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="basic-access-modifiers.html">
   56. ★ Access modifiers
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Concrete object composition
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="object-composition.html">
   57. ★ Object composition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="concrete-constructed-object-composition.html">
   58. ★ Concrete constructed object composition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="concrete-injected-object-composition.html">
   59. ★ Concrete injected object composition
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Polymorphism
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="interfaces.html">
   60. ★ Interfaces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="subtype-polymorphism.html">
   61. ★ Subtype polymorphism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inheritance.html">
   62. ★ Inheritance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="abstract-classes.html">
   63. ★ Abstract classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="advanced-access-modifiers.html">
   64. Access modifiers (advanced)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hiding.html">
   65. Hiding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="object-type-conversions.html">
   66. Type conversions (of objects)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Abstract object composition
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="abstract-constructed-object-composition.html">
   67. ★ Abstract constructed object composition
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   68. ★ Abstract injected object composition
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Substitutability
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="variance.html">
   69. ★ Variance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="liskov-substitution-principle.html">
   70. ★ Liskov substitution principle
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Generics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="generics.html">
   71. ★ Generics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="generic-type-parameters.html">
   72. ★ Generic type parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="generic-types.html">
   73. ★ Generic types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="generic-methods.html">
   74. Generic methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-parameter-constraints.html">
   75. Type parameter constraints
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="variant-generic-interfaces.html">
   76. Variant generic interfaces
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Maintainability
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="maintainability.html">
   77. ★ Maintainability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="requirements.html">
   78. Requirements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="correctness.html">
   79. Correctness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code-smells.html">
   80. Code smells and anti-patterns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coupling.html">
   81. Coupling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cohesion.html">
   82. Cohesion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="refactoring.html">
   83. Refactoring
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Principles
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="design-principles.html">
   84. Design principles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="single-responsibility-principle.html">
   85. Single responsibility principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interface-segregation-principle.html">
   86. Interface segregation principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="deep-classes.html">
   87. Deep classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="types-over-tests.html">
   88. Types over tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="define-errors-out-of-existence.html">
   89. Define errors out of existence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="open-closed-principle.html">
   90. Open-closed principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dependency-inversion-principle.html">
   91. Dependency inversion principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="composition-over-inheritance.html">
   92. Composition over inheritance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="documentation-driven-development.html">
   93. Documentation-driven development
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Patterns
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="design-patterns.html">
   94. Design patterns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="strategy-pattern.html">
   95. Strategy pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="delegates.html">
   96. Delegates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="extension-methods.html">
   97. Extension methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="null-object-pattern.html">
   98. Null object pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="observer-pattern.html">
   99. Observer pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="events.html">
   100. Events
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="adapter-pattern.html">
   101. Adapter pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bridge-pattern.html">
   102. Bridge pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="factory-method-pattern.html">
   103. Factory method pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="composite-pattern.html">
   104. Composite pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="state-pattern.html">
   105. State pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iterator-pattern.html">
   106. Iterator pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="visitor-pattern.html">
   107. Visitor pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pattern-matching.html">
   108. Pattern matching
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lambdas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lambdas.html">
   109. Lambdas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linq.html">
   110. LINQ
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  TODO
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="enumerators.html">
   111. Enumerators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexers.html">
   112. Indexers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="streams.html">
   113. Streams
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="advanced-exceptions.html">
   114. Advanced exceptions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prototypes.html">
   115. Prototypes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="base-class-library.html">
   116. Base class library
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="boxing.html">
   117. Boxing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="structure-types.html">
   118. Structure types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="anonymous-types.html">
   119. Anonymous types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="abstraction.html">
   120. Abstraction / Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indirection.html">
   121. Indirection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="business-logic.html">
   122. Business logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="business-objects.html">
   123. Business objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="debugging.html">
   124. Debugging
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Epilogue
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="reading.html">
   Suggested reading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/chrokh/the-oo-way/main?urlpath=tree/docs/chapters/abstract-injected-object-composition.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/chrokh/the-oo-way/issues/new?title=Issue%20on%20page%20%2Fchapters/abstract-injected-object-composition.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapters/abstract-injected-object-composition.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/chapters/abstract-injected-object-composition.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   68.1. Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definition">
   68.2. Definition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examples">
   68.3. Examples
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#substitution-ciphers">
     68.3.1. Substitution ciphers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#flip-flop-ciphers">
     68.3.2. Flip Flop ciphers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#composite-ciphers">
     68.3.3. Composite ciphers
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   68.4. Exercises
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Abstract injected object composition</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   68.1. Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definition">
   68.2. Definition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examples">
   68.3. Examples
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#substitution-ciphers">
     68.3.1. Substitution ciphers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#flip-flop-ciphers">
     68.3.2. Flip Flop ciphers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#composite-ciphers">
     68.3.3. Composite ciphers
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   68.4. Exercises
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="abstract-injected-object-composition">
<h1><span class="section-number">68. </span>Abstract injected object composition<a class="headerlink" href="#abstract-injected-object-composition" title="Permalink to this headline">#</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Work in progress.</p>
</div>
<div class="info admonition">
<p class="admonition-title">Prerequisites</p>
<p>In this chapter we’re exploring the object composition abstraction level that we refer to as “abstract constructed object composition”. Please have a look at the chapter <a class="reference internal" href="object-composition.html#object-composition-abstraction-levels"><span class="std std-ref">object composition</span></a> if you have not already.</p>
</div>
<section id="motivation">
<h2><span class="section-number">68.1. </span>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">#</a></h2>
<p>It is time.
We are finally ready to talk about abstraction depdendency injection.
This is the creme de la creme in object oriented programming.</p>
<p>With abstract injected object composition we are able to swap out both types and values at run-time.
Meaning that we don’t couple to any particular concrete implementation or type at compile-time.
This makes our code <a class="reference internal" href="coupling.html"><span class="doc std std-doc">decoupled</span></a> and increases <a class="reference internal" href="maintainability.html"><span class="doc std std-doc">maintainability</span></a>.</p>
<p>As we will see in one of the examples, abstract injected object composition enables us to follow the maxim <a class="reference internal" href="composition-over-inheritance.html"><span class="doc std std-doc">composition over inheritance</span></a>.
As if that wasn’t enough, almost all <a class="reference internal" href="design-patterns.html"><span class="doc std std-doc">design patterns</span></a> are, in one way or another, using abstract injected object composition.</p>
<p>Enough motivation, let’s get in to it.</p>
</section>
<section id="definition">
<h2><span class="section-number">68.2. </span>Definition<a class="headerlink" href="#definition" title="Permalink to this headline">#</a></h2>
<p>An object composition is abstract if the compile-time type of the composed object is abstract.
It is injected if the composed object is constructed outside of the composing object and instead passed into it (via the constructor, a method, or property).</p>
<p>Remember, we’ve discussed the notion of <span class="xref myst">injection</span> in the chapter on concrete injected object composition.
But in short, the idea is that insted of instantiating the object ourselves, we let someone else be responsible for instantiating that object and then passing it to us.
Instead of, for example, having a constructor that accepts some parameters that I’m going to use to instantiate some object, I simply use the type of that object as the parameter type.
Instead of asking others to send me some data so that I can instantiate an object, I simply ask them for the object instead.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Instead of instantiating the dependency ourselves, we simply parameterize a method or a constructor so that callers can pass the dependency.</p>
</div>
<p>Importantly though, now we’re talking about <em>abstract</em> injected object composition.
Which means that the compile-time type of the composed object <em>must</em> be abstract.
Meaning, must be an <a class="reference internal" href="interfaces.html"><span class="doc std std-doc">interface</span></a> or an <a class="reference internal" href="abstract-classes.html"><span class="doc std std-doc">abstract class</span></a>.</p>
</section>
<section id="examples">
<h2><span class="section-number">68.3. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">#</a></h2>
<section id="substitution-ciphers">
<h3><span class="section-number">68.3.1. </span>Substitution ciphers<a class="headerlink" href="#substitution-ciphers" title="Permalink to this headline">#</a></h3>
<p>Let’s replace <a class="reference internal" href="inheritance.html"><span class="doc std std-doc">inheritance</span></a> with composition.
Remember how we’ve struggled, in the chapters on <a class="reference internal" href="methods.html"><span class="doc std std-doc">methods</span></a>, <a class="reference internal" href="inheritance.html"><span class="doc std std-doc">inheritance</span></a>, and <a class="reference internal" href="abstract-classes.html"><span class="doc std std-doc">abstract classes</span></a> to get rid of the duplicated <code class="docutils literal notranslate"><span class="pre">foreach</span></code> loop in substitution ciphers.
The loop that iterates over an input <code class="docutils literal notranslate"><span class="pre">string</span></code>, calls a method that takes a <code class="docutils literal notranslate"><span class="pre">char</span></code> and depending on the cipher returns a <code class="docutils literal notranslate"><span class="pre">char</span></code> or a <code class="docutils literal notranslate"><span class="pre">string</span></code>, and then concatenates the result.</p>
<p>The problem has been that some ciphers, like the Caesar cipher, returns a <code class="docutils literal notranslate"><span class="pre">char</span></code> when encoding a <code class="docutils literal notranslate"><span class="pre">char</span></code>, while others, like the Robber’s language, returns a <code class="docutils literal notranslate"><span class="pre">string</span></code> when encoding a <code class="docutils literal notranslate"><span class="pre">char</span></code>.
Well, when we’re using composition rather than inheritance, this is no longer a big deal.
Check this out:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">ICharToCharCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">interface</span><span class="w"> </span><span class="n">IStringToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">interface</span><span class="w"> </span><span class="n">ICharToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div>
    <div id='dotnet-interactive-this-cell-2245.Microsoft.DotNet.Interactive.Http.HttpPort' style='display: none'>
        The below script needs to be able to find the current output cell; this is an easy method to get it.
    </div>
    <script type='text/javascript'>
async function probeAddresses(probingAddresses) {
    function timeout(ms, promise) {
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                reject(new Error('timeout'))
            }, ms)
            promise.then(resolve, reject)
        })
    }

    if (Array.isArray(probingAddresses)) {
        for (let i = 0; i < probingAddresses.length; i++) {

            let rootUrl = probingAddresses[i];

            if (!rootUrl.endsWith('/')) {
                rootUrl = `${rootUrl}/`;
            }

            try {
                let response = await timeout(1000, fetch(`${rootUrl}discovery`, {
                    method: 'POST',
                    cache: 'no-cache',
                    mode: 'cors',
                    timeout: 1000,
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: probingAddresses[i]
                }));

                if (response.status == 200) {
                    return rootUrl;
                }
            }
            catch (e) { }
        }
    }
}

function loadDotnetInteractiveApi() {
    probeAddresses(["http://10.1.1.64:1024/", "http://127.0.0.1:1024/"])
        .then((root) => {
        // use probing to find host url and api resources
        // load interactive helpers and language services
        let dotnetInteractiveRequire = require.config({
        context: '2245.Microsoft.DotNet.Interactive.Http.HttpPort',
                paths:
            {
                'dotnet-interactive': `${root}resources`
                }
        }) || require;

            window.dotnetInteractiveRequire = dotnetInteractiveRequire;

            window.configureRequireFromExtension = function(extensionName, extensionCacheBuster) {
                let paths = {};
                paths[extensionName] = `${root}extensions/${extensionName}/resources/`;
                
                let internalRequire = require.config({
                    context: extensionCacheBuster,
                    paths: paths,
                    urlArgs: `cacheBuster=${extensionCacheBuster}`
                    }) || require;

                return internalRequire
            };
        
            dotnetInteractiveRequire([
                    'dotnet-interactive/dotnet-interactive'
                ],
                function (dotnet) {
                    dotnet.init(window);
                },
                function (error) {
                    console.log(error);
                }
            );
        })
        .catch(error => {console.log(error);});
    }

// ensure `require` is available globally
if ((typeof(require) !==  typeof(Function)) || (typeof(require.config) !== typeof(Function))) {
    let require_script = document.createElement('script');
    require_script.setAttribute('src', 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js');
    require_script.setAttribute('type', 'text/javascript');
    
    
    require_script.onload = function() {
        loadDotnetInteractiveApi();
    };

    document.getElementsByTagName('head')[0].appendChild(require_script);
}
else {
    loadDotnetInteractiveApi();
}

    </script>
</div></div></div>
</div>
<div class="cell docutils container" id="abstract-injected-object-composition-examples-adapter">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SubstitutionCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IStringToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">ICharToStringCipher</span><span class="w"> </span><span class="n">cipher</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">SubstitutionCipher</span><span class="w"> </span><span class="p">(</span><span class="n">ICharToStringCipher</span><span class="w"> </span><span class="n">cipher</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">cipher</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cipher</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">output</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">c</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">class</span><span class="w"> </span><span class="nc">CharToStringAdapter</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">ICharToCharCipher</span><span class="w"> </span><span class="n">cipher</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">CharToStringAdapter</span><span class="w"> </span><span class="p">(</span><span class="n">ICharToCharCipher</span><span class="w"> </span><span class="n">cipher</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">cipher</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cipher</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">input</span><span class="p">).</span><span class="n">ToString</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Instead of letting the substitution cipher be a superclass that other classes can subclass (meaning: is-a) we simply say that it’s a class that composes (meaning: has-a) other classes.</p>
<p>Pay special attention to how our concrete ciphers (<code class="docutils literal notranslate"><span class="pre">RobbersCipher</span></code>, <code class="docutils literal notranslate"><span class="pre">CaesarsCipher</span></code>, and <code class="docutils literal notranslate"><span class="pre">LeetCipher</span></code>) no longer need to implement the interface <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> and no longer need to implement the method <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">Encode</span> <span class="pre">(string</span> <span class="pre">input)</span></code>.
The string to string conversion is now instead achieved by means of abstract injected composition.</p>
<p>But what’s this <code class="docutils literal notranslate"><span class="pre">CharToStringAdapter</span></code>?
Well, that’s the <a class="reference internal" href="design-patterns.html"><span class="doc std std-doc">design pattern</span></a> known as “adapter pattern”.
But it’s also just a simple solution to the problem caused by some ciphers returning a <code class="docutils literal notranslate"><span class="pre">char</span></code> when encoding a <code class="docutils literal notranslate"><span class="pre">char</span></code> while others return a <code class="docutils literal notranslate"><span class="pre">string</span></code>.
With the adapter, which <em>also uses abstract injected object composition</em>, we can simply wrap any cipher that implements the interface <code class="docutils literal notranslate"><span class="pre">ICharToCharCipher</span></code> and make it behave as if it implemented the interface <code class="docutils literal notranslate"><span class="pre">ICharToStringCipher</span></code>.</p>
<p>So how do we use these classes?
Can we really treat all substitution ciphers uniformly now?</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RobbersCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">vowel</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">RobbersCipher</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">vowel</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">vowel</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vowel</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">consonants</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;BCDFGHJKLMNPQRSTVXYZ&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">consonants</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">Char</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">(</span><span class="n">input</span><span class="p">))</span><span class="w"> </span><span class="p">!=</span><span class="w"> </span><span class="p">-</span><span class="m">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s">$&quot;{input}{vowel}{input}&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s">$&quot;{input}&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">class</span><span class="w"> </span><span class="nc">LeetCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharToCharCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;L&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="sc">&#39;L&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="sc">&#39;4&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;4&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;O&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="sc">&#39;O&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;T&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="sc">&#39;7&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;7&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="sc">&#39;T&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;E&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="sc">&#39;3&#39;</span><span class="p">;</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;3&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="sc">&#39;E&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="k">default</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">input</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">class</span><span class="w"> </span><span class="nc">CaesarCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharToCharCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">steps</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">CaesarCipher</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">steps</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">steps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">steps</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">alphabet</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVXYZ&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">alphabet</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">Char</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">(</span><span class="n">input</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">newIndex</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">steps</span><span class="p">)</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">alphabet</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="p">!=</span><span class="w"> </span><span class="p">-</span><span class="m">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">newIndex</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">newIndex</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">alphabet</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Char</span><span class="p">.</span><span class="n">IsLower</span><span class="p">(</span><span class="n">input</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Char</span><span class="p">.</span><span class="n">ToLower</span><span class="p">(</span><span class="n">alphabet</span><span class="p">[</span><span class="n">newIndex</span><span class="p">]);</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">alphabet</span><span class="p">[</span><span class="n">newIndex</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">input</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">SubstitutionCipher</span><span class="w"> </span><span class="n">sub1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SubstitutionCipher</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">RobbersCipher</span><span class="p">(</span><span class="sc">&#39;o&#39;</span><span class="p">));</span><span class="w"></span>
<span class="n">SubstitutionCipher</span><span class="w"> </span><span class="n">sub2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SubstitutionCipher</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CharToStringAdapter</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CaesarCipher</span><span class="p">(</span><span class="m">1</span><span class="p">)));</span><span class="w"></span>
<span class="n">SubstitutionCipher</span><span class="w"> </span><span class="n">sub3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SubstitutionCipher</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CharToStringAdapter</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">LeetCipher</span><span class="p">()));</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Indeed we can.
Moreover, whenever we call the <code class="docutils literal notranslate"><span class="pre">Encode</span></code> method on any of these objects of type <code class="docutils literal notranslate"><span class="pre">SubstitutionCipher</span></code>, it’s the same, one and only, <code class="docutils literal notranslate"><span class="pre">foreach</span></code> loop that executes.
How about we call this mission accomplished?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">sub1</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">));</span><span class="w"></span>
<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">sub2</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">));</span><span class="w"></span>
<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">sub3</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HoHelollolo
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ifmmp
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hello
</pre></div>
</div>
</div>
</div>
<p>In the end you might say that it was a bit silly that we tried to replace a simple <code class="docutils literal notranslate"><span class="pre">foreach</span></code> loop which in a later chapter we will replace with <a class="reference internal" href="linq.html"><span class="doc std std-doc">LINQ</span></a> anyway.
Nevertheless, the point is not that this particular loop was bad, but that this is an example of how you can find yourself in a position where you’re repeating the same code over and over again for each implementation or subclass.</p>
</section>
<section id="flip-flop-ciphers">
<h3><span class="section-number">68.3.2. </span>Flip Flop ciphers<a class="headerlink" href="#flip-flop-ciphers" title="Permalink to this headline">#</a></h3>
<p>Let’s explore our newfound power.
You must have known that we were going to return to the flipflops.
In the chapter on <a class="reference internal" href="concrete-injected-object-composition.html#concrete-injected-object-composition-examples-general-flip-flop"><span class="std std-ref">abstract injected object composition</span></a> we discussed how our flip flop cipher was coupled to the idea of a Caesar cipher even though it in a sense has nothing to do with that specific cipher.</p>
<p>Let’s implement it more generally using abstract injected object composition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">FlipFlopCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IStringToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">ICharToStringCipher</span><span class="w"> </span><span class="n">flip</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">ICharToStringCipher</span><span class="w"> </span><span class="n">flop</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">FlipFlopCipher</span><span class="w"> </span><span class="p">(</span><span class="n">ICharToStringCipher</span><span class="w"> </span><span class="n">flip</span><span class="p">,</span><span class="w"> </span><span class="n">ICharToStringCipher</span><span class="w"> </span><span class="n">flop</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">flip</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">flip</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">flop</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">flop</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">=</span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="p">&lt;</span><span class="n">input</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="p">++)</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">output</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">flip</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="n">output</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">flop</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Notice how nothing in the implementation had to change except for the types.
It’s exactly the same implementation as in the chapter on <a class="reference internal" href="concrete-injected-object-composition.html#concrete-injected-object-composition-examples-general-flip-flop"><span class="std std-ref">abstract injected object composition</span></a> except for the fact that we’ve generalized the types and also have made the <code class="docutils literal notranslate"><span class="pre">FlipFlopCipher</span></code> implement the interface <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code>.
In other words, we’ve moved from concrete compile-time types to abstract compile-time types.</p>
<p>Why did we choose to, in the constructor, take objects of type <code class="docutils literal notranslate"><span class="pre">ICharToStringCipher</span></code> rather than <code class="docutils literal notranslate"><span class="pre">ICharToChar</span></code>?
Think back to the example we just gave where we eliminated the <a class="reference internal" href="#abstract-injected-object-composition-examples-adapter"><span class="std std-ref">duplicated foreach</span></a>.
By introducing an adapter we are able to convert any <code class="docutils literal notranslate"><span class="pre">ICharToCharCipher</span></code> to a <code class="docutils literal notranslate"><span class="pre">ICharToStringCipher</span></code>.
The inverse conversion however is not as trivial.
So if we want the <code class="docutils literal notranslate"><span class="pre">FlipFlopCipher</span></code> to support all substitution ciphers that we have seen then we must pick the type to which others can be converted.</p>
<p>Let’s see this thing in action, shall we?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">FlipFlopCipher</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FlipFlopCipher</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="nf">RobbersCipher</span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="nf">CharToStringAdapter</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CaesarCipher</span><span class="p">(</span><span class="m">1</span><span class="p">)));</span><span class="w"></span>

<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="s">&quot;HELLO WORLD&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HaHFLaLMO WPRaRMDaD
</pre></div>
</div>
</div>
</div>
<p>Let me be the first to say that our ciphers are finally getting pretty interesting.
After the exercises in this chapter I’m suspecting you’ll have a pretty good idea of the power of <a class="reference internal" href="composition-over-inheritance.html"><span class="doc std std-doc">composition over inheritance</span></a> and abstract injected object composition.</p>
</section>
<section id="composite-ciphers">
<span id="abstract-injected-object-composition-examples-composite-ciphers"></span><h3><span class="section-number">68.3.3. </span>Composite ciphers<a class="headerlink" href="#composite-ciphers" title="Permalink to this headline">#</a></h3>
<p>One final example.
Here’s a classic.
How about a composite cipher that takes two ciphers in the constructor and applies both of them to whatever input we give it when encoding?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CompositeCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharToCharCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">ICharToCharCipher</span><span class="w"> </span><span class="n">first</span><span class="p">,</span><span class="w"> </span><span class="n">second</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">CompositeCipher</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">      </span><span class="n">ICharToCharCipher</span><span class="w"> </span><span class="n">first</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="n">ICharToCharCipher</span><span class="w"> </span><span class="n">second</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">first</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">first</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">second</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">second</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">second</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">first</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">input</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">CompositeCipher</span><span class="w"> </span><span class="n">composite</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CompositeCipher</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="k">new</span><span class="w"> </span><span class="nf">CaesarCipher</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"></span>
<span class="w">  </span><span class="k">new</span><span class="w"> </span><span class="nf">LeetCipher</span><span class="p">());</span><span class="w"></span>

<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">composite</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="sc">&#39;E&#39;</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F
</pre></div>
</div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>We named this cipher <code class="docutils literal notranslate"><span class="pre">CompositeCipher</span></code> because this essentially is an implementation of the <a class="reference internal" href="composite-pattern.html"><span class="doc std std-doc">Composite design pattern</span></a>.
More on that pattern later.</p>
</div>
<p>However, our composite cipher only works with ciphers of type <code class="docutils literal notranslate"><span class="pre">ICharToCharCipher</span></code>.
But if you think about it for a moment you will quickly realize that we could do the same thing for <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code>.
But to also support ciphers of type <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> we must duplicate the whole <code class="docutils literal notranslate"><span class="pre">CompositeCipher</span></code> implementation.
We don’t want that, so let’s drop that idea for now and let’s get back to it when we get to <a class="reference internal" href="generics.html"><span class="doc std std-doc">generics</span></a>.</p>
</section>
</section>
<section id="exercises">
<h2><span class="section-number">68.4. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<div class="exercise admonition" id="chapters/abstract-injected-object-composition-exercise-0">

<p class="admonition-title"><span class="caption-number">Exercise 68.1 </span></p>
<section id="exercise-content">
<p>What is the difference between <em>constructed</em> and <em>injected</em> abstract object composition?</p>
</section>
</div>
<div class="exercise admonition" id="chapters/abstract-injected-object-composition-exercise-1">

<p class="admonition-title"><span class="caption-number">Exercise 68.2 </span></p>
<section id="exercise-content">
<p>What is the difference between <em>concrete</em> and <em>abstract</em> injected object composition?</p>
</section>
</div>
<div class="exercise admonition" id="chapters/abstract-injected-object-composition-exercise-2">

<p class="admonition-title"><span class="caption-number">Exercise 68.3 </span></p>
<section id="exercise-content">
<p>Invent and implement another class that implements <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code>, <code class="docutils literal notranslate"><span class="pre">ICharToCharCipher</span></code>, or <code class="docutils literal notranslate"><span class="pre">ICharToStringCipher</span></code> and that uses abstract injected object composition to work.</p>
</section>
</div>
<div class="exercise admonition" id="chapters/abstract-injected-object-composition-exercise-3">

<p class="admonition-title"><span class="caption-number">Exercise 68.4 </span></p>
<section id="exercise-content">
<p>Draw the <a class="reference internal" href="object-composition.html#composition-quadrants"><span class="std std-ref">quadrant diagram of abstraction levels in object composition</span></a> and explain all four abstraction levels.
Remember to give examples of each.</p>
</section>
</div>
<div class="exercise admonition" id="ex:array-cipher">

<p class="admonition-title"><span class="caption-number">Exercise 68.5 </span></p>
<section id="exercise-content">
<p>Write a class called <code class="docutils literal notranslate"><span class="pre">SequenceCipher</span></code> that implements the interface <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code>.
Its constructor must take a single argument of type <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher[]</span></code>, called <code class="docutils literal notranslate"><span class="pre">ciphers</span></code>.
The <code class="docutils literal notranslate"><span class="pre">Encode</span></code> method runs the <code class="docutils literal notranslate"><span class="pre">Encode</span></code> method of each <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> in <code class="docutils literal notranslate"><span class="pre">ciphers</span></code>, in sequence, on the input.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>It should behave as in the usage example below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="k">new</span><span class="w"> </span><span class="nf">SequenceCipher</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">IStringToStringCipher</span><span class="p">[]</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="nf">SubstitutionCipher</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">RobbersCipher</span><span class="p">(</span><span class="sc">&#39;O&#39;</span><span class="p">)),</span><span class="w"></span>
<span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="nf">SubstitutionCipher</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">RobbersCipher</span><span class="p">(</span><span class="sc">&#39;E&#39;</span><span class="p">)),</span><span class="w"></span>
<span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="nf">SubstitutionCipher</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CharToStringAdapter</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">LeetCipher</span><span class="p">())),</span><span class="w"></span>
<span class="w">    </span><span class="p">}).</span><span class="n">Encode</span><span class="p">(</span><span class="s">&quot;HELLO ELITE&quot;</span><span class="p">)</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>H3H0H3H3131013113101310 31310131I73707373
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="exercise admonition" id="abstract-injected-object-composition:exercises:predicates">

<p class="admonition-title"><span class="caption-number">Exercise 68.6 </span></p>
<section id="exercise-content">
<p>Write a class called <code class="docutils literal notranslate"><span class="pre">ConditionalCharToCharCipher</span></code> that implements the interface <code class="docutils literal notranslate"><span class="pre">ICharToCharCipher</span></code>.
Its constructor must take two arguments.
One is of type <code class="docutils literal notranslate"><span class="pre">ICharToCharCipher</span></code> and the other is of type <code class="docutils literal notranslate"><span class="pre">ICharPredicate</span></code>.
The interface <code class="docutils literal notranslate"><span class="pre">ICharPredicate</span></code> must look like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">ICharPredicate</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="nf">Check</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Encode</span></code> method runs the <code class="docutils literal notranslate"><span class="pre">Encode</span></code> method of the <code class="docutils literal notranslate"><span class="pre">ICharToCharCipher</span></code> if and only if the method <code class="docutils literal notranslate"><span class="pre">Check</span></code> in <code class="docutils literal notranslate"><span class="pre">ICharPredicate</span></code> returns <code class="docutils literal notranslate"><span class="pre">true</span></code> when passed the <code class="docutils literal notranslate"><span class="pre">char</span></code> that we are trying to encode.
To test whether this class works you must also implement a concrete implementation for <code class="docutils literal notranslate"><span class="pre">ICharPredicate</span></code>.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>For the usage example, let’s use a simple predicate that just checks whether its input is uppercase or not.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">IsUpperCase</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharPredicate</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">Check</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Char</span><span class="p">.</span><span class="n">IsUpper</span><span class="p">(</span><span class="n">input</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>With that in place we should be able to set up a conditional cipher.
We should then be able to run the encode method of that cipher and depending on what we pass it either get encoded characters or the same characters that we pass it back.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">ConditionalCharToCharCipher</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConditionalCharToCharCipher</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="k">new</span><span class="w"> </span><span class="nf">CaesarCipher</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"></span>
<span class="w">  </span><span class="k">new</span><span class="w"> </span><span class="nf">IsUpperCase</span><span class="p">());</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>If we pass an uppercase letter it should encode it using the cipher.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="sc">&#39;A&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>B
</pre></div>
</div>
</div>
</div>
<p>If we pass a lowercase letter it should return the same letter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a
</pre></div>
</div>
</div>
</div>
<p><em>Extra questions:</em></p>
<ol class="simple">
<li><p>Why are we <em>injecting</em> rather than <em>constructing</em> the <code class="docutils literal notranslate"><span class="pre">ICharPredicate</span></code>? Explain in your own words.</p></li>
<li><p>One could argue that it wouldn’t make sense to couple to <code class="docutils literal notranslate"><span class="pre">ICharToStringCipher</span></code> instead of <code class="docutils literal notranslate"><span class="pre">ICharToCharCipher</span></code>. How would you defend that position?</p></li>
</ol>
<p>By the way, in the chapters on <a class="reference internal" href="generic-types.html"><span class="doc std std-doc">generics</span></a> we will learn how to generalize this implementation so that it also works for <code class="docutils literal notranslate"><span class="pre">ICharToString</span></code> ciphers without adding duplicated code.</p>
</section>
</div>
<hr class="docutils" />
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-csharp"
        },
        kernelOptions: {
            kernelName: ".net-csharp",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-csharp'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="abstract-constructed-object-composition.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">67. </span>Abstract constructed object composition</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="variance.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">69. </span>Variance</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Christopher Okhravi<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>