
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>71. Subtype polymorphism &#8212; The Object Oriented Way (DRAFT)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="72. Inheritance" href="inheritance.html" />
    <link rel="prev" title="70. Interfaces" href="interfaces.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-V69WNXD095"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-V69WNXD095');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">The Object Oriented Way (DRAFT)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fundamentals
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="sets.html">
   1. ★ Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions.html">
   2. ★ Functions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Terminals
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="terminals.html">
   3. Terminals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="standard-out.html">
   4. Standard out
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="standard-in.html">
   5. Standard in
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Computation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="algorithms.html">
   6. ★ Algorithms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="computation.html">
   7. ★ Computation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="syntax.html">
   8. ★ Syntax
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="semantics.html">
   9. ★ Semantics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="compilation.html">
   10. ★ Compilation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="execution.html">
   11. ★ Execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interpretation.html">
   12. ★ Interpretation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="comments.html">
   13. ★ Comments
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Values
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="values.html">
   14. ★ Values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="variables.html">
   15. ★ Variables
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statements &amp; expressions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="statements.html">
   16. Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="expressions.html">
   17. Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="operators.html">
   18. Operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="paradigms.html">
   19. Paradigms
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data types
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="data-types.html">
   20. ★ Data types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-conversions.html">
   21. Type conversions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-checking.html">
   22. ★ Type-checking
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-systems.html">
   23. ★ Type systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-hierarchies.html">
   24. Type hierarchies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-testing.html">
   25. Type testing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basic types
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="simple-types.html">
   26. Simple types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="enums.html">
   27. Enums
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="value-tuples.html">
   28. Value tuples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arrays.html">
   29. Arrays
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Control flow
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="selection.html">
   30. ★ Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iteration.html">
   31. ★ Iteration
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Input/output
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="command-line-arguments.html">
   32. Command line arguments
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Mutability
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mutability.html">
   33. Mutability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="immutable-objects.html">
   34. Immutable objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="value-and-reference-semantics.html">
   35. Value and reference semantics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Nothingness
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="nothingness.html">
   36. ★ Nothingness
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Procedures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="methods.html">
   37. ★ Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="method-composition.html">
   38. Method composition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="static-classes.html">
   39. Static classes (Modules)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="static-methods.html">
   40. ★ Static methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="static-variables.html">
   41. Static variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="static-constructors.html">
   42. Static constructors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="purity.html">
   43. Purity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="overloading.html">
   44. ★ Overloading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="recursion.html">
   45. Recursion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modules
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="data-structures.html">
   46. Data structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="scope.html">
   47. Scope
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="namespaces.html">
   48. Namespaces
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Exceptions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="basic-exceptions.html">
   49. Exceptions (part 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stack-traces.html">
   50. Stack traces
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Requirements
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="requirements.html">
   51. ★ Requirements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="validation.html">
   52. Validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="verification.html">
   53. Verification
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Maintainability
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="maintainability.html">
   54. ★ Maintainability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="refactoring.html">
   55. (★E) Refactoring
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coupling.html">
   56. Coupling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dont-repeat-yourself.html">
   57. Don’t repeat yourself
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fail-fast.html">
   58. ★ Fail fast
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Objects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="objects.html">
   59. ★ Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classes.html">
   60. ★ Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fields.html">
   61. ★ Fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="instance-methods.html">
   62. ★ Instance methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="constructors.html">
   63. ★ Constructors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="properties.html">
   64. ★ Properties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="basic-access-modifiers.html">
   65. ★ Access modifiers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="extension-methods.html">
   66. Extension methods
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Concrete object composition
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="object-composition.html">
   67. ★ Object composition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="concrete-constructed-object-composition.html">
   68. ★ Concrete constructed object composition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="concrete-injected-object-composition.html">
   69. ★ Concrete injected object composition
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Subtype polymorphism
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="interfaces.html">
   70. ★ Interfaces
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   71. ★ Subtype polymorphism
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inheritance.html">
   72. ★ Inheritance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="abstract-classes.html">
   73. ★ Abstract classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="advanced-access-modifiers.html">
   74. Access modifiers (advanced)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hiding.html">
   75. Hiding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="object-type-conversions.html">
   76. Type conversions (of objects)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Abstract object composition
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="abstract-constructed-object-composition.html">
   77. ★ Abstract constructed object composition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="abstract-injected-object-composition.html">
   78. ★ Abstract injected object composition
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Substitutability
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="variance.html">
   79. ★ Variance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="liskov-substitution-principle.html">
   80. ★ Liskov substitution principle
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Generics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="generics.html">
   81. ★ Generics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="generic-type-parameters.html">
   82. ★ Generic type parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="generic-types.html">
   83. ★ Generic types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="generic-methods.html">
   84. Generic methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="type-parameter-constraints.html">
   85. Type parameter constraints
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="variant-generic-interfaces.html">
   86. ★ Variant generic interfaces
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Principles
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="design-principles.html">
   87. Design principles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="types-over-tests.html">
   88. (★E) Types over tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="single-responsibility-principle.html">
   89. Single responsibility principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="interface-segregation-principle.html">
   90. (★E) Interface segregation principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="deep-classes.html">
   91. Deep classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="define-errors-out-of-existence.html">
   92. Define errors out of existence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="open-closed-principle.html">
   93. (★E) Open-closed principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dependency-inversion-principle.html">
   94. (★E) Dependency inversion principle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="composition-over-inheritance.html">
   95. (★E) Composition over inheritance
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Design patterns
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="design-patterns.html">
   96. Design patterns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="strategy-pattern.html">
   97. ★ Strategy pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="null-object-pattern.html">
   98. Null object pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bridge-pattern.html">
   99. ★ Bridge pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="delegates.html">
   100. ★ Delegates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="observer-pattern.html">
   101. ★ Observer pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="events.html">
   102. ★ Events
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="adapter-pattern.html">
   103. Adapter pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="factory-method-pattern.html">
   104. ★ Factory method pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="composite-pattern.html">
   105. Composite pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="state-pattern.html">
   106. State pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iterator-pattern.html">
   107. Iterator pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="visitor-pattern.html">
   108. Visitor pattern
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pattern-matching.html">
   109. Pattern matching
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lambdas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lambdas.html">
   110. Lambdas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linq.html">
   111. LINQ
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  TODO
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="code-smells.html">
   112. Code smells and anti-patterns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="enumerators.html">
   113. Enumerators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexers.html">
   114. Indexers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="streams.html">
   115. Streams
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="custom-exceptions.html">
   116. Custom exceptions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prototypes.html">
   117. Prototypes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="base-class-library.html">
   118. Base class library
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="boxing.html">
   119. Boxing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="structure-types.html">
   120. Structure types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="anonymous-types.html">
   121. Anonymous types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="abstraction.html">
   122. Abstraction / Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indirection.html">
   123. Indirection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="business-logic.html">
   124. Business logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="business-objects.html">
   125. Business objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="debugging.html">
   126. Debugging
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Epilogue
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="reading.html">
   Suggested reading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/chrokh/the-oo-way/main?urlpath=tree/docs/chapters/subtype-polymorphism.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/chrokh/the-oo-way/issues/new?title=Issue%20on%20page%20%2Fchapters/subtype-polymorphism.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapters/subtype-polymorphism.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/chapters/subtype-polymorphism.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   71.1. Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definition">
   71.2. Definition
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inclusion">
     71.2.1. Inclusion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#substitutability">
     71.2.2. Substitutability
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nominal-subtyping">
     71.2.3. Nominal subtyping
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notation">
     71.2.4. Notation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dynamic-dispatch">
     71.2.5. Dynamic dispatch
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#constructors">
     71.2.6. Constructors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#beyond-inclusion">
     71.2.7. Beyond inclusion
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examples">
   71.3. Examples
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numbers">
     71.3.1. Numbers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#animals">
     71.3.2. Animals
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ciphers">
     71.3.3. Ciphers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     71.3.4. Dynamic dispatch
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#subtype-polymorpism-identity-cipher">
     71.3.5. Identity cipher
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#replace-conditional-with-polymorphism">
     71.3.6. Replace conditional with polymorphism
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discussion">
   71.4. Discussion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   71.5. Exercises
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Subtype polymorphism</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   71.1. Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definition">
   71.2. Definition
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inclusion">
     71.2.1. Inclusion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#substitutability">
     71.2.2. Substitutability
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nominal-subtyping">
     71.2.3. Nominal subtyping
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notation">
     71.2.4. Notation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dynamic-dispatch">
     71.2.5. Dynamic dispatch
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#constructors">
     71.2.6. Constructors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#beyond-inclusion">
     71.2.7. Beyond inclusion
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examples">
   71.3. Examples
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numbers">
     71.3.1. Numbers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#animals">
     71.3.2. Animals
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ciphers">
     71.3.3. Ciphers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     71.3.4. Dynamic dispatch
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#subtype-polymorpism-identity-cipher">
     71.3.5. Identity cipher
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#replace-conditional-with-polymorphism">
     71.3.6. Replace conditional with polymorphism
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discussion">
   71.4. Discussion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   71.5. Exercises
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="subtype-polymorphism">
<span id="polymorphism"></span><h1><span class="section-number">71. </span>Subtype polymorphism<a class="headerlink" href="#subtype-polymorphism" title="Permalink to this headline">#</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Work in progress.</p>
</div>
<section id="motivation">
<h2><span class="section-number">71.1. </span>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">#</a></h2>
<p>The time has come to talk about subtype polymorphism.
If you haven’t studied polymorphism before, let me just spill the beans and tell you that this is, arguably, <em>the most important idea in object oriented programming</em>.
Luckily it is also the most mind-bendingly interesting topic in object oriented programming.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Polymorphism allows us to explicitly or implicitly define a contract that multiple different types can implement.
This allows us to use these different types interchangeably without needing to be concerned about which particular type we have.</p>
</div>
<p>The word “polymorphism” comes from Greek and means “many-shaped”.
There are many types of polymorphism and in this chapter we’re specifically talking about subtype polymorphism.
Which types of polymorphism exists depends on who you ask but I tend to follow the division of <span id="id1">Cardelli and Wegner [<a class="reference internal" href="bibliography.html#id7" title="Luca Cardelli and Peter Wegner. On understanding types, data abstraction, and polymorphism. ACM Computing Surveys (CSUR), 17(4):471–523, 1985.">1985</a>]</span> where we have the following four types:</p>
<ol class="simple">
<li><p><a class="reference internal" href="generics.html"><span class="doc std std-doc">Parametric polymorphism</span></a>.</p></li>
<li><p>Inclusion / subtype / overriding polymorphism.</p></li>
<li><p><a class="reference internal" href="overloading.html"><span class="doc std std-doc">Overloading polymorphism</span></a>.</p></li>
<li><p><a class="reference internal" href="object-type-conversions.html"><span class="doc std std-doc">Coercion polymorphism</span></a>.</p></li>
</ol>
<p>In this chapter we will talk about subtype polymorphism.
In previous chapters we have already talked about <a class="reference internal" href="overloading.html"><span class="doc std std-doc">overloading</span></a> without calling it overloading polymorphism.
In a coming chapter on <a class="reference internal" href="object-type-conversions.html"><span class="doc std std-doc">object type conversions</span></a> we will talk about “implicit type conversions” which is what coercion polymorphism tends to refer to.
Finally, we will also talk about parametric polymorphism in the chapter on <a class="reference internal" href="generics.html"><span class="doc std std-doc">generics</span></a> since this is what the C# implementation of the concept is called.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When someone just says “polymorphism” in the context of a discussion around object oriented programming they are most likely referring to subtype polymorphism.</p>
</div>
</section>
<section id="definition">
<h2><span class="section-number">71.2. </span>Definition<a class="headerlink" href="#definition" title="Permalink to this headline">#</a></h2>
<section id="inclusion">
<h3><span class="section-number">71.2.1. </span>Inclusion<a class="headerlink" href="#inclusion" title="Permalink to this headline">#</a></h3>
<p>To understand subtype/inclusion polymorphism we must understand the idea of subtyping or of inclusion.
Think back to the notion of subsets from the chapter on <a class="reference internal" href="sets.html"><span class="doc std std-doc">sets</span></a>.</p>
<p>Let’s say that we’ve got a set of cats that we call <span class="math notranslate nohighlight">\(\mathit{Cat}\)</span> and a set of dogs that we call <span class="math notranslate nohighlight">\(\mathit{Dog}\)</span>.
If we claim that <span class="math notranslate nohighlight">\(\mathit{Cat}\)</span> and <span class="math notranslate nohighlight">\(\mathit{Dog}\)</span> are <em>subtypes</em> of <span class="math notranslate nohighlight">\(\mathit{Animal}\)</span> then we are claiming that they are subsets of <span class="math notranslate nohighlight">\(\mathit{Animal}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathit{Cat} \subset \mathit{Animal}\\
\mathit{Dog} \subset \mathit{Animal}
\end{split}\]</div>
<p>In terms of <em>subsets</em> this means that all members of the set <span class="math notranslate nohighlight">\(\mathit{Cat}\)</span> are also members of the set <span class="math notranslate nohighlight">\(\mathit{Animal}\)</span>.
Same for dogs.
Have a look back in the chapter on <a class="reference internal" href="sets.html"><span class="doc std std-doc">sets</span></a> if this isn’t obvious.</p>
<p>In terms of <em>subtypes</em> however this means that a <span class="math notranslate nohighlight">\(\mathit{Cat}\)</span> can be used at any point where an <span class="math notranslate nohighlight">\(\mathit{Animal}\)</span> is expected.
Same for dogs.</p>
<p>The opposite of a subtype is called a “supertype”.
Instead of the subtype-supertype terminology you will also often find the pairs child type-parent type, and base type-derived type.
The terminology is summarized in <a class="reference internal" href="#tbl-subtype-supertype-terminology"><span class="std std-numref">Table 71.1</span></a>.</p>
<table class="colwidths-auto table" id="tbl-subtype-supertype-terminology">
<caption><span class="caption-number">Table 71.1 </span><span class="caption-text">Alternatives to the subtype-supertype terminology.</span><a class="headerlink" href="#tbl-subtype-supertype-terminology" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Supertype</p></th>
<th class="text-align:center head"><p>Subtype</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>Parent type</p></td>
<td class="text-align:center"><p>Child type</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>Base type</p></td>
<td class="text-align:center"><p>Derived type</p></td>
</tr>
</tbody>
</table>
</section>
<section id="substitutability">
<h3><span class="section-number">71.2.2. </span>Substitutability<a class="headerlink" href="#substitutability" title="Permalink to this headline">#</a></h3>
<p>This idea of being able to use some type instead of another is known as “substitutability”.
We’ll talk more about what ought to be substitutable for what in the chapter on <a class="reference internal" href="liskov-substitution-principle.html#liskov-substitution-principle"><span class="std std-ref">Liskov’s substitution principle</span></a>.
In general however, this means that the <em>state and behavior</em> of any subtype must be a legal state and behavior of its supertype.</p>
<p>Assume that the two types <code class="docutils literal notranslate"><span class="pre">Cat</span></code> and <code class="docutils literal notranslate"><span class="pre">Dog</span></code> are subtypes of <code class="docutils literal notranslate"><span class="pre">Animal</span></code>.
Inversely, <code class="docutils literal notranslate"><span class="pre">Animal</span></code> is a supertype of both <code class="docutils literal notranslate"><span class="pre">Cat</span></code> and <code class="docutils literal notranslate"><span class="pre">Dog</span></code>.
This means that any value of type <code class="docutils literal notranslate"><span class="pre">Cat</span></code> and any value of type <code class="docutils literal notranslate"><span class="pre">Dog</span></code> must at all times be legal states and behaviors given our definition of <code class="docutils literal notranslate"><span class="pre">Animal</span></code>.
In other words, all dogs and all cats must at all times, with no exceptions, behave like animals.
If this condition is satisfied then we are free to declare that <code class="docutils literal notranslate"><span class="pre">Dog</span></code> and <code class="docutils literal notranslate"><span class="pre">Cat</span></code> are subtypes of <code class="docutils literal notranslate"><span class="pre">Animal</span></code>.</p>
<p>Remember how we, way back in the chapter on <a class="reference internal" href="data-types.html#run-time-and-compile-time-types"><span class="std std-ref">data types</span></a>, said that the type on the left doesn’t necessarily have to be the same as the type on the right?
Or in other words, how the compile-time type doesn’t necessarily have to be the same as the run-time type.
Well, let’s unpack that statement now.
Have a look at this code:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Animal</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Cat</span><span class="p">();</span><span class="w"></span>
<span class="n">Animal</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Dog</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>The left-hand type, the compile-time type, of both variables is <code class="docutils literal notranslate"><span class="pre">Animal</span></code>.
However, the right-hand type, the run-time type, is <code class="docutils literal notranslate"><span class="pre">Cat</span></code> for one of the variables and <code class="docutils literal notranslate"><span class="pre">Dog</span></code> for the other.
For this code to compile <code class="docutils literal notranslate"><span class="pre">Cat</span></code> and <code class="docutils literal notranslate"><span class="pre">Dog</span></code> must both be subtypes of <code class="docutils literal notranslate"><span class="pre">Animal</span></code>.</p>
<p>Let’s generalize.
A run-time type can be used if the run-time type is the same as the expected compile-time type or if the run-time type is a subtype of the compile-time type.
In other words, whenever we state that a certain compile-time type is expected we can use values that at run-time have exactly that type or any subtype of that type.</p>
</section>
<section id="nominal-subtyping">
<h3><span class="section-number">71.2.3. </span>Nominal subtyping<a class="headerlink" href="#nominal-subtyping" title="Permalink to this headline">#</a></h3>
<p>Remember how we, in the chapter on <a class="reference internal" href="type-systems.html"><span class="doc std std-doc">type systems</span></a>, discussed that a type system is either nominal, structural or some combination of the two.
If a type system is nominal, then subtyping is determined based on the fact that we declare that it is.
In a structural type system however, subtyping is determined on the basis of the structure of different types.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>C# is a nominally typed language, and hence implements nominal subtyping.
A subtype is a subtype if we nominally declare that it is.</p>
</div>
<p>Unfortunately, the existence of <a class="reference internal" href="basic-exceptions.html#exceptions"><span class="std std-ref">exceptions</span></a> means that it is quite simple to nominally declare that something is a subtype yet structurally violate the rules of, what is known as, “behavioral subtyping”.
More on this in the chapter on the <a class="reference internal" href="liskov-substitution-principle.html#liskov-substitution-principle"><span class="std std-ref">Liskov substitution principle</span></a> (LSP).</p>
<p>Type systems that implement structural subtyping often need to deal with whether or not to support both “width subtyping” and “depth subtyping”.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The static type checker <a class="reference external" href="https://flow.org">Flow</a> for the language JavaScript is an example of a type system that supports both depth subtyping and width subtyping.</p>
</div>
</section>
<section id="notation">
<h3><span class="section-number">71.2.4. </span>Notation<a class="headerlink" href="#notation" title="Permalink to this headline">#</a></h3>
<p>So how do we declare one type a subtype of another type?
Well, in C#, and many other object oriented langauges, there are usually two ways.
A subtype relationship can be established by either:</p>
<ol class="simple">
<li><p><a class="reference internal" href="interfaces.html"><span class="doc std std-doc">Interface implementation</span></a>, or</p></li>
<li><p><a class="reference internal" href="inheritance.html"><span class="doc std std-doc">Inheritance</span></a>.</p></li>
</ol>
<p>If type <code class="docutils literal notranslate"><span class="pre">A</span></code> implements the <code class="docutils literal notranslate"><span class="pre">interface</span></code> defined by type <code class="docutils literal notranslate"><span class="pre">B</span></code> then <code class="docutils literal notranslate"><span class="pre">A</span></code> is considered a subtype of <code class="docutils literal notranslate"><span class="pre">B</span></code>.
If type <code class="docutils literal notranslate"><span class="pre">A</span></code> inherits from the class or abstract class <code class="docutils literal notranslate"><span class="pre">B</span></code> then <code class="docutils literal notranslate"><span class="pre">A</span></code> is a subtype of <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p>
<p>We’ll explore how to create subtype relationships by means of inheritance in the chapter on <a class="reference internal" href="inheritance.html"><span class="doc std std-doc">inheritance</span></a>.
In this chapter we will focus on how to create subtype relationships by means of interfaces.</p>
<p>Notationally you will often find the less-than-sign (<code class="docutils literal notranslate"><span class="pre">&lt;</span></code>) being used to denote subtyping.
Where the subtype is on the left and the supertype is on the right.
In C# however we tend to use the same symbol as for <a class="reference internal" href="interfaces.html"><span class="doc std std-doc">interface</span></a> implementation and <a class="reference internal" href="inheritance.html"><span class="doc std std-doc">inheritance</span></a>, namely colon (<code class="docutils literal notranslate"><span class="pre">:</span></code>).
The subtype is still on the left, and the supertype on the right.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cat</span> <span class="p">:</span> <span class="n">Animal</span>
<span class="n">Dog</span> <span class="p">:</span> <span class="n">Animal</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you happen to already be familiar with <a class="reference internal" href="inheritance.html"><span class="doc std std-doc">inheritance</span></a> it is important to realize that subtype does not <em>necessarily</em> mean subclass.
While a subtype can be created by means of inheritance it can also be created by means of interface implementation.</p>
</div>
</section>
<section id="dynamic-dispatch">
<span id="id2"></span><h3><span class="section-number">71.2.5. </span>Dynamic dispatch<a class="headerlink" href="#dynamic-dispatch" title="Permalink to this headline">#</a></h3>
<p>But what does all this matter you ask?
Why would I want to “treat” cats and dogs as animals instead of as cats and dogs?
Well, the answer lies in something known as “dynamic dispatch”.</p>
<p>By declaring that <code class="docutils literal notranslate"><span class="pre">Cat</span></code> and <code class="docutils literal notranslate"><span class="pre">Dog</span></code> both implement the interface <code class="docutils literal notranslate"><span class="pre">IAnimal</span></code> we can use <code class="docutils literal notranslate"><span class="pre">IAnimal</span></code> as the compile-time type.
Importantly we can call whatever methods and access whatever properties the type <code class="docutils literal notranslate"><span class="pre">IAnimal</span></code> declares.
However, we can do this without having to care at all about which particular implementation of <code class="docutils literal notranslate"><span class="pre">IAnimal</span></code> we happen to get at runtime.
As long as whatever members we’re accessing are defined in <code class="docutils literal notranslate"><span class="pre">IAnimal</span></code> then we are guaranteed that these members will be available in all subtypes of <code class="docutils literal notranslate"><span class="pre">IAnimal</span></code>.</p>
<p>Before leaving the section on dynamic dispatch I should also mention that most languages that implement dynamic dispatch by means of subtype polymorphism provide us with <em>single</em> dynamic dispatch.
This means that the implementation that is executed depends on the run-time type of one variable.
We will learn about <em>multiple</em> dynamic dispatch in the chapters on <a class="reference internal" href="visitor-pattern.html"><span class="doc std std-doc">visitor pattern</span></a> and <a class="reference internal" href="pattern-matching.html"><span class="doc std std-doc">pattern matching</span></a>.</p>
</section>
<section id="constructors">
<h3><span class="section-number">71.2.6. </span>Constructors<a class="headerlink" href="#constructors" title="Permalink to this headline">#</a></h3>
<p>It is important to understand that subtype polymorphism doesn’t require constructors to have any particular signature.
As we will see in the chapter on <a class="reference internal" href="inheritance.html"><span class="doc std std-doc">inheritance</span></a>, inheriting from a class will force you to call one of the base classes constructor (albeit possibly implicitly) but you’re nevertheless able to define your own constructors in the subclass.
In the case of interfaces we’re only demanding that implementors define some public instance members.
The constructors can consequently vary wildly between different implementations of an interface.</p>
</section>
<section id="beyond-inclusion">
<h3><span class="section-number">71.2.7. </span>Beyond inclusion<a class="headerlink" href="#beyond-inclusion" title="Permalink to this headline">#</a></h3>
<p>In the chapter on <a class="reference internal" href="interfaces.html"><span class="doc std std-doc">interfaces</span></a> and here we’ve emphasized the importance of letting the supertype be the <a class="reference internal" href="sets.html#intersection"><span class="std std-ref">intersection</span></a> of all the subtypes, not the <a class="reference internal" href="sets.html#union"><span class="std std-ref">union</span></a> of them.
Otherwise we would force subtypes to provide implementations for members they have no sensible implementation for.
This is a path that leads to a sea of run-time errors.
So let us agree to stray away before it is too late.</p>
<p>Why would you get the idea that you should put members that are exclusive to some set of subtypes in the supertype?
Well, when we treat something as it’s supertype then we can <em>only</em> access whatever members are defined in that supertype.
It doesn’t matter what additional members might exist in the subtype.
We only know about what’s in the compile-time type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">Generalization</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">void</span><span class="w"> </span><span class="nf">SharedMethod</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">class</span><span class="w"> </span><span class="nc">Specialization</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Generalization</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">SharedMethod</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">UniqueMethod</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div>
    <div id='dotnet-interactive-this-cell-4020.Microsoft.DotNet.Interactive.Http.HttpPort' style='display: none'>
        The below script needs to be able to find the current output cell; this is an easy method to get it.
    </div>
    <script type='text/javascript'>
async function probeAddresses(probingAddresses) {
    function timeout(ms, promise) {
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                reject(new Error('timeout'))
            }, ms)
            promise.then(resolve, reject)
        })
    }

    if (Array.isArray(probingAddresses)) {
        for (let i = 0; i < probingAddresses.length; i++) {

            let rootUrl = probingAddresses[i];

            if (!rootUrl.endsWith('/')) {
                rootUrl = `${rootUrl}/`;
            }

            try {
                let response = await timeout(1000, fetch(`${rootUrl}discovery`, {
                    method: 'POST',
                    cache: 'no-cache',
                    mode: 'cors',
                    timeout: 1000,
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: probingAddresses[i]
                }));

                if (response.status == 200) {
                    return rootUrl;
                }
            }
            catch (e) { }
        }
    }
}

function loadDotnetInteractiveApi() {
    probeAddresses(["http://10.1.0.120:1024/", "http://127.0.0.1:1024/"])
        .then((root) => {
        // use probing to find host url and api resources
        // load interactive helpers and language services
        let dotnetInteractiveRequire = require.config({
        context: '4020.Microsoft.DotNet.Interactive.Http.HttpPort',
                paths:
            {
                'dotnet-interactive': `${root}resources`
                }
        }) || require;

            window.dotnetInteractiveRequire = dotnetInteractiveRequire;

            window.configureRequireFromExtension = function(extensionName, extensionCacheBuster) {
                let paths = {};
                paths[extensionName] = `${root}extensions/${extensionName}/resources/`;
                
                let internalRequire = require.config({
                    context: extensionCacheBuster,
                    paths: paths,
                    urlArgs: `cacheBuster=${extensionCacheBuster}`
                    }) || require;

                return internalRequire
            };
        
            dotnetInteractiveRequire([
                    'dotnet-interactive/dotnet-interactive'
                ],
                function (dotnet) {
                    dotnet.init(window);
                },
                function (error) {
                    console.log(error);
                }
            );
        })
        .catch(error => {console.log(error);});
    }

// ensure `require` is available globally
if ((typeof(require) !==  typeof(Function)) || (typeof(require.config) !== typeof(Function))) {
    let require_script = document.createElement('script');
    require_script.setAttribute('src', 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js');
    require_script.setAttribute('type', 'text/javascript');
    
    
    require_script.onload = function() {
        loadDotnetInteractiveApi();
    };

    document.getElementsByTagName('head')[0].appendChild(require_script);
}
else {
    loadDotnetInteractiveApi();
}

    </script>
</div></div></div>
</div>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Specialization</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Specialization</span><span class="p">();</span><span class="w"></span>
<span class="n">special</span><span class="p">.</span><span class="n">SharedMethod</span><span class="p">();</span><span class="w"> </span><span class="c1">// Ok.</span>
<span class="n">special</span><span class="p">.</span><span class="n">UniqueMethod</span><span class="p">();</span><span class="w"> </span><span class="c1">// Ok.</span>

<span class="n">Generalization</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Specialization</span><span class="p">();</span><span class="w"></span>
<span class="n">general</span><span class="p">.</span><span class="n">SharedMethod</span><span class="p">();</span><span class="w"> </span><span class="c1">// Ok.</span>
<span class="n">general</span><span class="p">.</span><span class="n">UniqueMethod</span><span class="p">();</span><span class="w"> </span><span class="c1">// Does not compile!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(7,9): error CS1061: &#39;Generalization&#39; does not contain a definition for &#39;UniqueMethod&#39; and no accessible extension method &#39;UniqueMethod&#39; accepting a first argument of type &#39;Generalization&#39; could be found (are you missing a using directive or an assembly reference?)
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<p>When you treat a subtype as a supertype you loose the ability to call methods that only exist in the subtype.
Said differently, it is possible for the subtype to define members that fall outside the inclusion relationship.
It is possible for the subtype to, outside of its inclusion relationship, be an extension of the supertype.
It is possible for the subtype to, outside of its inclusion relationship, do more than the supertype.
An even other way of saying this is it is possible that it is a <em>part</em> of the subtype that makes it a subtype of the supertype.</p>
<p>We’ll talk about this a bit more when we get to the chapter on the design principle known as the <a class="reference internal" href="liskov-substitution-principle.html#liskov-substitution-principle"><span class="std std-ref">liskov substitution principle</span></a>.
As long as the subtype is behaviorally substitutable for the supertype, we’re fione.
But, be sure to only put things in the supertype that actually are implementable for all conceivable subtypes.</p>
</section>
</section>
<section id="examples">
<h2><span class="section-number">71.3. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">#</a></h2>
<section id="numbers">
<h3><span class="section-number">71.3.1. </span>Numbers<a class="headerlink" href="#numbers" title="Permalink to this headline">#</a></h3>
<p>In actual languages like C#, different number types are usually not subtypes of each other.
However, let us dispense with that practicality for a moment so that we can deepen our understanding of subtypes.</p>
<p>If we’re talking about sets, then the set of natural numbers is a subset of the set of integers, which is a subset of the set of rational numbers, which is a subset of the set of real numbers.</p>
<div class="math notranslate nohighlight">
\[
\mathbb{N} \subset \mathbb{Z} \quad \quad \quad
\mathbb{Z} \subset \mathbb{Q} \quad \quad \quad
\mathbb{Q} \subset \mathbb{R}
\]</div>
<figure class="align-default" id="id5">
<a class="reference internal image-reference" href="https://upload.wikimedia.org/wikipedia/commons/1/17/Number-systems.svg"><img alt="https://upload.wikimedia.org/wikipedia/commons/1/17/Number-systems.svg" height="200" src="https://upload.wikimedia.org/wikipedia/commons/1/17/Number-systems.svg" /></a>
<figcaption>
<p><span class="caption-number">Fig. 71.1 </span><span class="caption-text">Illustration of how real numbers (<span class="math notranslate nohighlight">\(\mathbb{R}\)</span>) include rational numbers (<span class="math notranslate nohighlight">\(\mathbb{Q}\)</span>), which include integers (<span class="math notranslate nohighlight">\(\mathbb{Z}\)</span>), which include natural numbers (<span class="math notranslate nohighlight">\(\mathbb{N}\)</span>). [<a class="reference external" href="https://en.wikipedia.org/wiki/Real_number#/media/File:Number-systems.svg">Image source</a>].</span><a class="headerlink" href="#id5" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>If we’re talking about types then it would be quite reasonable to design a type system where the natural numbers (<code class="docutils literal notranslate"><span class="pre">Natural</span></code>) is a subtype of integers (<code class="docutils literal notranslate"><span class="pre">Integer</span></code>), which is a subtype of rational numbers (<code class="docutils literal notranslate"><span class="pre">Rational</span></code>), which is a subtype of real numbers (<code class="docutils literal notranslate"><span class="pre">Real</span></code>).
C# does not have types like these, but bear with me.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Natural</span> <span class="p">:</span> <span class="n">Integer</span>
<span class="n">Integer</span> <span class="p">:</span> <span class="n">Rational</span>
<span class="n">Rational</span> <span class="p">:</span> <span class="n">Real</span>
</pre></div>
</div>
<p>Such a type system would imply that any value of type <code class="docutils literal notranslate"><span class="pre">Natural</span></code> can be used whenever you expect a value of type <code class="docutils literal notranslate"><span class="pre">Integer</span></code>, <code class="docutils literal notranslate"><span class="pre">Rational</span></code>, or <code class="docutils literal notranslate"><span class="pre">Real</span></code>.
Since subtyping is a transitive relationship, <code class="docutils literal notranslate"><span class="pre">Natural</span></code> is a subtype of <code class="docutils literal notranslate"><span class="pre">Real</span></code>.
Since all natural numbers behave like integers, rationals, and reals defining a subtype relation like this seems entirely fine.
Of course, the relationship is directed and so we can’t go the other way.
Trying to use a value of type <code class="docutils literal notranslate"><span class="pre">Real</span></code> where a value of type <code class="docutils literal notranslate"><span class="pre">Natural</span></code> does not type-check since <code class="docutils literal notranslate"><span class="pre">Real</span></code> is not a subtype of <code class="docutils literal notranslate"><span class="pre">Natural</span></code>.</p>
</section>
<section id="animals">
<h3><span class="section-number">71.3.2. </span>Animals<a class="headerlink" href="#animals" title="Permalink to this headline">#</a></h3>
<p>Let’s declare an interface <code class="docutils literal notranslate"><span class="pre">IAnimal</span></code> and two classes <code class="docutils literal notranslate"><span class="pre">Cat</span></code> and <code class="docutils literal notranslate"><span class="pre">Dog</span></code> that we declare as subtypes of <code class="docutils literal notranslate"><span class="pre">IAnimal</span></code>.
Let’s ignore implementations for now and just make sure that our types make sense.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">IAnimal</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="k">class</span><span class="w"> </span><span class="nc">Cat</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IAnimal</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="k">class</span><span class="w"> </span><span class="nc">Dog</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IAnimal</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>With this code in place we can actually compile and run the code above where we declare the variables <code class="docutils literal notranslate"><span class="pre">a1</span></code> and <code class="docutils literal notranslate"><span class="pre">a2</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">IAnimal</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Cat</span><span class="p">();</span><span class="w"></span>
<span class="n">IAnimal</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Dog</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Remember: The run-time type of these two variables is the type on the right.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">a1</span><span class="p">.</span><span class="n">GetType</span><span class="p">());</span><span class="w"></span>
<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">a2</span><span class="p">.</span><span class="n">GetType</span><span class="p">());</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">Cat</span>
<span class="go">Dog</span>
</pre></div>
</div>
</section>
<section id="ciphers">
<h3><span class="section-number">71.3.3. </span>Ciphers<a class="headerlink" href="#ciphers" title="Permalink to this headline">#</a></h3>
<p>Let’s get back to our ciphers and explore the power of dynamic dispatch and subtype polymorphism.
In the chapter on <a class="reference internal" href="interfaces.html"><span class="doc std std-doc">interfaces</span></a> we designed the three interfaces <code class="docutils literal notranslate"><span class="pre">ICharToCharCipher</span></code>, <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code>, and <code class="docutils literal notranslate"><span class="pre">ICharToStringCipher</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">ICharToCharCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">interface</span><span class="w"> </span><span class="n">IStringToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">interface</span><span class="w"> </span><span class="n">ICharToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>We then showed that <code class="docutils literal notranslate"><span class="pre">RobbersCipher</span></code>, <code class="docutils literal notranslate"><span class="pre">CaesarCipher</span></code>, and <code class="docutils literal notranslate"><span class="pre">ReverseCipher</span></code> all (at least) implement the interface <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RobbersCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharToStringCipher</span><span class="p">,</span><span class="w"> </span><span class="n">IStringToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">vowel</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">RobbersCipher</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">vowel</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">vowel</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vowel</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">consonants</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;BCDFGHJKLMNPQRSTVXYZ&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">consonants</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">Char</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">(</span><span class="n">input</span><span class="p">))</span><span class="w"> </span><span class="p">!=</span><span class="w"> </span><span class="p">-</span><span class="m">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s">$&quot;{input}{vowel}{input}&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s">$&quot;{input}&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">output</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">Encode</span><span class="w"> </span><span class="p">(</span><span class="n">letter</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CaesarCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharToCharCipher</span><span class="p">,</span><span class="w"> </span><span class="n">IStringToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">steps</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">CaesarCipher</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">steps</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">steps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">steps</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">alphabet</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVXYZ&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">alphabet</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">Char</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">(</span><span class="n">input</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">newIndex</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">steps</span><span class="p">)</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">alphabet</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="p">!=</span><span class="w"> </span><span class="p">-</span><span class="m">1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">newIndex</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">newIndex</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">alphabet</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Char</span><span class="p">.</span><span class="n">IsLower</span><span class="p">(</span><span class="n">input</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Char</span><span class="p">.</span><span class="n">ToLower</span><span class="p">(</span><span class="n">alphabet</span><span class="p">[</span><span class="n">newIndex</span><span class="p">]);</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">alphabet</span><span class="p">[</span><span class="n">newIndex</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">input</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">output</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">Encode</span><span class="p">(</span><span class="n">letter</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ReverseCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IStringToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">=</span><span class="n">input</span><span class="p">.</span><span class="n">Length</span><span class="p">-</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="p">&gt;=</span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="p">--)</span><span class="w"></span>
<span class="w">      </span><span class="n">output</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>In this chapter we’ve emphaiszed that you can only access whatever members are defined in the supertype whenever you treat something as its supertype.
Let’s look at what this means in the context of our ciphers.</p>
<p>Take the Robber’s cipher for example.
Let’s say we want to be able to change the vowel that any particular instance of <code class="docutils literal notranslate"><span class="pre">RobbersCipher</span></code> uses.
Let’s say that we want to implement that idea using a public <a class="reference internal" href="properties.html"><span class="doc std std-doc">property</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">RobbersCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICharToStringCipher</span><span class="p">,</span><span class="w"> </span><span class="n">IStringToStringCipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">Vowel</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// This line is new!</span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">RobbersCipher</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">vowel</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Vowel</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vowel</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">consonants</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;BCDFGHJKLMNPQRSTVXYZ&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">consonants</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">Char</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">(</span><span class="n">input</span><span class="p">))</span><span class="w"> </span><span class="p">!=</span><span class="w"> </span><span class="p">-</span><span class="m">1</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s">$&quot;{input}{Vowel}{input}&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="s">$&quot;{input}&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">output</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="n">Encode</span><span class="w"> </span><span class="p">(</span><span class="n">letter</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Clearly we cannot add this property to neither the interface <code class="docutils literal notranslate"><span class="pre">ICharToStringCipher</span></code> nor <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> since not all ciphers are centered around the idea of a vowel.
However, as long as <code class="docutils literal notranslate"><span class="pre">RobbersCipher</span></code> still implement all members of the interfaces we declare it to be a member of, then we are free to add as many additional members as we want.
<code class="docutils literal notranslate"><span class="pre">RobbersCipher</span></code> can now do <em>more</em> than what is required for being an implementation of <code class="docutils literal notranslate"><span class="pre">ICipher</span></code>.</p>
<p>If we’ve got an instance of <code class="docutils literal notranslate"><span class="pre">RobbersCipher</span></code> where the compile-time type also is <code class="docutils literal notranslate"><span class="pre">RobbersCipher</span></code> then we can access the <code class="docutils literal notranslate"><span class="pre">Vowel</span></code> property to change the vowel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">RobbersCipher</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RobbersCipher</span><span class="p">(</span><span class="sc">&#39;o&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">cipher</span><span class="p">.</span><span class="n">Vowel</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>However, if the compile-time type of our variable is, for example, <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> then we can <em>not</em> access the <code class="docutils literal notranslate"><span class="pre">Vowel</span></code> property.
The compiler error that we get is actually quite revealing.</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">IStringToStringCipher</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RobbersCipher</span><span class="p">(</span><span class="sc">&#39;o&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">cipher</span><span class="p">.</span><span class="n">Vowel</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2,8): error CS1061: &#39;IStringToStringCipher&#39; does not contain a definition for &#39;Vowel&#39; and no accessible extension method &#39;Vowel&#39; accepting a first argument of type &#39;IStringToStringCipher&#39; could be found (are you missing a using directive or an assembly reference?)
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<p>The error tells us that if all the type-checker knows is that it has something of type <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> then it couldn’t possibly guarantee that we can access a property called <code class="docutils literal notranslate"><span class="pre">Vowel</span></code>.
Why?
Well because <code class="docutils literal notranslate"><span class="pre">Vowel</span></code> is not actually defined in <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code>.
The interface <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> knows absolutely nothing about vowels.
Only one of the bazillion different possible implementations of <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code>, namely <code class="docutils literal notranslate"><span class="pre">RobbersCipher</span></code>, happens to know about vowels.</p>
</section>
<section id="id3">
<h3><span class="section-number">71.3.4. </span>Dynamic dispatch<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>But what do we even gain from this?
Well, this means that we can use all concrete types that implement the same interface interchangably.
It means that we can write code that depends on <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> instead of any particular class.</p>
<p>So what’s this business of dynamic dispatch?
Well, say that we write code that depends on <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> and then call the method <code class="docutils literal notranslate"><span class="pre">Encode</span></code> on an object of that type.
We don’t know whether that object is of type <code class="docutils literal notranslate"><span class="pre">ReverseCipher</span></code>, <code class="docutils literal notranslate"><span class="pre">CaesarCipher</span></code>, or any other potential cipher that we have yet to come up with.
The fact that the type implements <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> means that we can be certain that the object has a method with the signature <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">Encode</span> <span class="pre">(string</span> <span class="pre">input)</span></code> which means that we can call it.
The actual implementation of <code class="docutils literal notranslate"><span class="pre">Encode</span></code> that will be run depends on what the run-time type we happen to have.
This is the dynamic dispatch.
The implementation is “late-bound”.</p>
<p>Let’s look at an example.
How about the idea of running the encoding method of a cipher twice?
Let’s define two simple <a class="reference internal" href="methods.html#local-functions"><span class="std std-ref">local functions</span></a>.
One that runs an <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> twice, and one that runs an <code class="docutils literal notranslate"><span class="pre">ICharToCharCipher</span></code> twice.
We’ll get back to using classes soon, but let’s just start with something simple.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">string</span><span class="w"> </span><span class="nf">encodeStringTwice</span><span class="w"> </span><span class="p">(</span><span class="n">IStringToStringCipher</span><span class="w"> </span><span class="n">cipher</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">cipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">input</span><span class="p">));</span><span class="w"></span>

<span class="kt">char</span><span class="w"> </span><span class="nf">encodeCharTwice</span><span class="w"> </span><span class="p">(</span><span class="n">ICharToCharCipher</span><span class="w"> </span><span class="n">cipher</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">cipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">input</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>What’s excellent about these two methods is that they work on any current and future types that implement the corresponding interface.
Let’s take these methods for a spin to see if they actually work.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="w"> </span><span class="n">encodeStringTwice</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">RobbersCipher</span><span class="p">(</span><span class="sc">&#39;o&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Ape&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Apopopope
</pre></div>
</div>
</div>
</div>
<p>Now let’s try if we can pass the reversing cipher.
Of course, since reversing a string twice takes us back to the original string we should simply get the original string back.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="w"> </span><span class="n">encodeStringTwice</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ReverseCipher</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;backwards&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>backwards
</pre></div>
</div>
</div>
</div>
<p>Finally, let’s see if pass the Caeasar cipher class to the method that encodes single characters twice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="w"> </span><span class="n">encodeCharTwice</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CaesarCipher</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C
</pre></div>
</div>
</div>
</div>
<p>Both methods seem to work.
Pretty neat right?</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Not only do these two methods work for all current implementations of our interfaces, but they will also work <em>for all future implementations</em>.</p>
</div>
<p>We can just keep on adding new classes and the methods <code class="docutils literal notranslate"><span class="pre">encodeStringTwice</span></code> and <code class="docutils literal notranslate"><span class="pre">encodeCharTwice</span></code> will work for all these classes so long as we make sure that they implement the appropriate interface.</p>
<p>This is subtype polymorphism and dynamic dispatch.
We’re treating different types as if they are of the same type.
We’re treating different types of ciphers as if they are all of the same type.</p>
</section>
<section id="subtype-polymorpism-identity-cipher">
<span id="identity-cipher"></span><h3><span class="section-number">71.3.5. </span>Identity cipher<a class="headerlink" href="#subtype-polymorpism-identity-cipher" title="Permalink to this headline">#</a></h3>
<p>While we’re at it, let’s also write the simplest possible cipher that we can image.
Namely a cipher that doesn’t actually perform any modifications of the input message but instead just returns it as it is.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">NoCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICipher</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">input</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>In general, something like a <code class="docutils literal notranslate"><span class="pre">NoCipher</span></code> is known as the “identity”.
In the context of ciphers, we would call this “the identity cipher”.
In the context of multiplication, the number <span class="math notranslate nohighlight">\(1\)</span> is the identity.
In the context of addition, the number <span class="math notranslate nohighlight">\(0\)</span> is the identity.</p>
<p>You can also think of <code class="docutils literal notranslate"><span class="pre">NoCipher</span></code> as a <a class="reference internal" href="null-object-pattern.html"><span class="doc std std-doc">null object</span></a> which we will talk more about when we get to design patterns.</p>
<p>Does the <code class="docutils literal notranslate"><span class="pre">encodeTwice</span></code> method work for instances of type <code class="docutils literal notranslate"><span class="pre">NoCipher</span></code> as well?
Yes, of course.</p>
<p>Welcome to the powerful world of subtype polymorphism.</p>
</section>
<section id="replace-conditional-with-polymorphism">
<span id="id4"></span><h3><span class="section-number">71.3.6. </span>Replace conditional with polymorphism<a class="headerlink" href="#replace-conditional-with-polymorphism" title="Permalink to this headline">#</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Work in progress.</p>
</div>
</section>
</section>
<section id="discussion">
<h2><span class="section-number">71.4. </span>Discussion<a class="headerlink" href="#discussion" title="Permalink to this headline">#</a></h2>
<p>Not impressed enough yet?
Not a problem.
We’re only scratching the surface of the usefulness of subtype polymorphism.</p>
<p>As you will come to learn, subtype polymorphism is at the heart of almost all object oriented <a class="reference internal" href="design-patterns.html"><span class="doc std std-doc">design patterns</span></a> you will see how subtype polymorphism is the key mechanism of almost all object oriented design patterns.</p>
</section>
<section id="exercises">
<h2><span class="section-number">71.5. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<div class="exercise admonition" id="chapters/subtype-polymorphism-exercise-0">

<p class="admonition-title"><span class="caption-number">Exercise 71.1 </span></p>
<section id="exercise-content">
<p>If type <code class="docutils literal notranslate"><span class="pre">A</span></code> is a subset of type <code class="docutils literal notranslate"><span class="pre">B</span></code> then we would say that the set that models type <code class="docutils literal notranslate"><span class="pre">B</span></code> <em>includes</em> the set that models type <code class="docutils literal notranslate"><span class="pre">A</span></code>.
If we call the sets <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> then we could write: <span class="math notranslate nohighlight">\(A \subset B\)</span>.
What does it mean that <span class="math notranslate nohighlight">\(A\)</span> <em>includes</em> <span class="math notranslate nohighlight">\(B\)</span>?</p>
</section>
</div>
<div class="exercise admonition" id="chapters/subtype-polymorphism-exercise-1">

<p class="admonition-title"><span class="caption-number">Exercise 71.2 </span></p>
<section id="exercise-content">
<p>Assume that you have the following code:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">Animal</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="k">class</span><span class="w"> </span><span class="nc">Cat</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Animal</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="k">class</span><span class="w"> </span><span class="nc">Dog</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Animal</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
</pre></div>
</div>
<ol class="simple">
<li><p>Which of the following lines will compile and which ones will not?</p></li>
<li><p>Explain <em>why</em> each line will or will not compile.</p></li>
</ol>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Cat</span><span class="p">();</span><span class="w"></span>
<span class="kt">var</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Dog</span><span class="p">();</span><span class="w"></span>
<span class="kt">var</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animal</span><span class="p">();</span><span class="w"></span>
<span class="n">Cat</span><span class="w"> </span><span class="n">a4</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Cat</span><span class="p">();</span><span class="w"></span>
<span class="n">Cat</span><span class="w"> </span><span class="n">a5</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Dog</span><span class="p">();</span><span class="w"></span>
<span class="n">Cat</span><span class="w"> </span><span class="n">a6</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animal</span><span class="p">();</span><span class="w"></span>
<span class="n">Dog</span><span class="w"> </span><span class="n">a7</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Cat</span><span class="p">();</span><span class="w"></span>
<span class="n">Dog</span><span class="w"> </span><span class="n">a8</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Dog</span><span class="p">();</span><span class="w"></span>
<span class="n">Dog</span><span class="w"> </span><span class="n">a9</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animal</span><span class="p">();</span><span class="w"></span>
<span class="n">Animal</span><span class="w"> </span><span class="n">a10</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Cat</span><span class="p">();</span><span class="w"></span>
<span class="n">Animal</span><span class="w"> </span><span class="n">a11</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Dog</span><span class="p">();</span><span class="w"></span>
<span class="n">Animal</span><span class="w"> </span><span class="n">a12</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animal</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
</section>
</div>
<div class="exercise admonition" id="chapters/subtype-polymorphism-exercise-2">

<p class="admonition-title"><span class="caption-number">Exercise 71.3 </span></p>
<section id="exercise-content">
<p>Which of the following types (if any) are supported by the method <code class="docutils literal notranslate"><span class="pre">encodeCharTwice</span></code>?</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RobbersCipher</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ReverseCipher</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LeetCipher</span></code></p></li>
</ol>
<p>Note that we are talking about <code class="docutils literal notranslate"><span class="pre">encodeCharTwice</span></code> <em>not</em> <code class="docutils literal notranslate"><span class="pre">encodeStringTwice</span></code>.</p>
</section>
</div>
<div class="exercise admonition" id="ex:subtype-polymorphism:encodeNTimes">

<p class="admonition-title"><span class="caption-number">Exercise 71.4 </span></p>
<section id="exercise-content">
<p>Write a method with the following signature:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">string</span><span class="w"> </span><span class="nf">encodeNTimes</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">IStringToStringCipher</span><span class="w"> </span><span class="n">cipher</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">times</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The method should apply the same cipher multiple times to a single input.
The parameter <code class="docutils literal notranslate"><span class="pre">cipher</span></code> determines the cipher that should be used.
The parameter <code class="docutils literal notranslate"><span class="pre">times</span></code> determines how many times the cipher should be applied to the input string.
The parameter <code class="docutils literal notranslate"><span class="pre">input</span></code> determines the input to encode.</p>
<p>Since the method takes a cipher of type <code class="docutils literal notranslate"><span class="pre">IStringToStringCipher</span></code> you must be able to run the method with any of your ciphers that implement that interface.</p>
<p>When you’re done you should be able to run the following code and get the corresponding output.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="w"> </span><span class="n">encodeNTimes</span><span class="p">(</span><span class="s">&quot;ABC&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CaesarCipher</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DEF
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="w"> </span><span class="n">encodeNTimes</span><span class="p">(</span><span class="s">&quot;L&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RobbersCipher</span><span class="p">(</span><span class="sc">&#39;o&#39;</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LoLoLoL
</pre></div>
</div>
</div>
</div>
</section>
</div>
<div class="exercise admonition" id="chapters/subtype-polymorphism-exercise-4">

<p class="admonition-title"><span class="caption-number">Exercise 71.5 </span></p>
<section id="exercise-content">
<p>Is it possible to pass the class <code class="docutils literal notranslate"><span class="pre">LeetCipher</span></code> that you wrote in <a class="reference internal" href="interfaces.html#ex:interfaces:leet"><span class="std std-numref">Exercise 70.4</span></a> to the method <code class="docutils literal notranslate"><span class="pre">encodeNTimes</span></code> that you wrote in <a class="reference internal" href="#ex:subtype-polymorphism:encodeNTimes"><span class="std std-numref">Exercise 71.4</span></a>?
Why or why not?
If not, can we make it possible?</p>
</section>
</div>
<div class="exercise admonition" id="ex:subtype-polymorphism-own-types">

<p class="admonition-title"><span class="caption-number">Exercise 71.6 </span></p>
<section id="exercise-content">
<p>Come up with your own example of inclusion/subtying that involves at least three sets/types.
Explain why all members of each subtype is also a member of it’s supertype.</p>
</section>
</div>
<div class="exercise admonition" id="ex:subtype-polymorphism-implement-own-types">

<p class="admonition-title"><span class="caption-number">Exercise 71.7 </span></p>
<section id="exercise-content">
<ol class="simple">
<li><p>Write an interface that unifies the three types you designed in <a class="reference internal" href="#ex:subtype-polymorphism-own-types"><span class="std std-numref">Exercise 71.6</span></a>.</p></li>
<li><p>Declare at least one method/property to the interface.</p></li>
<li><p>All methods that the interface declares must make sense in all the implementations of the interface.</p></li>
<li><p>Write a class for each of the three types and make them implementations of the interface.</p></li>
<li><p>Show that they can be treated polymorphically by assigning instantiations of all three classes to variables with the interface as the compile-time type.</p></li>
</ol>
</section>
</div>
<div class="exercise admonition" id="chapters/subtype-polymorphism-exercise-7">

<p class="admonition-title"><span class="caption-number">Exercise 71.8 </span></p>
<section id="exercise-content">
<p>Start with the code you wrote in <a class="reference internal" href="#ex:subtype-polymorphism-implement-own-types"><span class="std std-numref">Exercise 71.7</span></a>.
Write a static method that (1) takes at least one argument whose type is the interface you’ve defined and (2) calls a method or accesses a property that’s defined in that interface.</p>
</section>
</div>
<div class="exercise admonition" id="chapters/subtype-polymorphism-exercise-8">

<p class="admonition-title"><span class="caption-number">Exercise 71.9 </span></p>
<section id="exercise-content">
<p>Give an example of <em>subtype polymorphism</em> and <em>single dynamic dispatch</em> in code.
Use code comments when necessary to get your point across.</p>
</section>
</div>
<div class="exercise admonition" id="chapters/subtype-polymorphism-exercise-9">

<p class="admonition-title"><span class="caption-number">Exercise 71.10 </span></p>
<section id="exercise-content">
<p>Why is it important that the signature of constructors can vary freely between subtypes?</p>
</section>
</div>
<div class="exercise admonition" id="chapters/subtype-polymorphism-exercise-10">

<p class="admonition-title"><span class="caption-number">Exercise 71.11 </span></p>
<section id="exercise-content">
<p>When we treat a subtype as a supertype, meaning when we let the compile-time type be the supertype, why can’t we call methods that are only defined in the subtype?</p>
</section>
</div>
<div class="exercise admonition" id="chapters/subtype-polymorphism-exercise-11">

<p class="admonition-title"><span class="caption-number">Exercise 71.12 </span></p>
<section id="exercise-content">
<p>Rewrite the class <code class="docutils literal notranslate"><span class="pre">Vowel</span></code> that you wrote in <code class="xref std std-numref docutils literal notranslate"><span class="pre">ex:constructors:vowel</span></code> so that each vowel is modeled by its own subtype of <code class="docutils literal notranslate"><span class="pre">IVowel</span></code>.</p>
</section>
</div>
<div class="exercise admonition" id="chapters/subtype-polymorphism-exercise-12">

<p class="admonition-title"><span class="caption-number">Exercise 71.13 </span></p>
<section id="exercise-content">
<p>Write a bunch of classes that can be used to model time in seconds, minutes, and hours.
Make sure that your code behaves according to the usage example below.</p>
<p>Hint: Consider converting to the base unit (seconds) before performing other conversions to avoid duplication.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">void</span><span class="w"> </span><span class="nf">printTime</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">Seconds</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">ToSeconds</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="n">Minutes</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">ToMinutes</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="n">Hours</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">ToHours</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&quot;{s.Number}s = {m.Number}mins = {h.Number}hrs.&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">printTime</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Seconds</span><span class="p">(</span><span class="m">4500</span><span class="p">));</span><span class="w"></span>
<span class="n">printTime</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Hours</span><span class="p">(</span><span class="m">0.75</span><span class="p">));</span><span class="w"></span>
<span class="n">printTime</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Minutes</span><span class="p">(</span><span class="m">15</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4500s = 75mins = 1.25hrs.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2700s = 45mins = 0.75hrs.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>900s = 15mins = 0.25hrs.
</pre></div>
</div>
</div>
</div>
<p>Rember the maxim <a class="reference internal" href="types-over-tests.html"><span class="doc std std-doc">types over tests</span></a>.
Illegal states should not be representable.</p>
</section>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-csharp"
        },
        kernelOptions: {
            kernelName: ".net-csharp",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-csharp'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="interfaces.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">70. </span>Interfaces</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="inheritance.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">72. </span>Inheritance</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Christopher Okhravi<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>