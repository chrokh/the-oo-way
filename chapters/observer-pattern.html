<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="78. Events" href="events.html" /><link rel="prev" title="76. Delegates" href="delegates.html" />

    <!-- Generated with Sphinx 5.0.2 and Furo 2023.03.27 -->
        <title>77. Observer pattern - The Object Oriented Way</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">The Object Oriented Way</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">The Object Oriented Way</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="syntax.html">1. Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="hello-world.html">2. Hello world</a></li>
<li class="toctree-l1"><a class="reference internal" href="compilation.html">3. Compilation</a></li>
<li class="toctree-l1"><a class="reference internal" href="execution.html">4. Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpretation.html">5. Interpretation</a></li>
<li class="toctree-l1"><a class="reference internal" href="comments.html">6. Comments</a></li>
<li class="toctree-l1"><a class="reference internal" href="values.html">7. Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="variables.html">8. Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">9. Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-types.html">10. Data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="expressions.html">11. Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="arithmetic-operators.html">12. Arithmetic operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="equality-operators.html">13. Equality operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="relational-operators.html">14. Relational operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="logical-operators.html">15. Logical operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-operator.html">16. Assignment operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="precedence.html">17. Precedence</a></li>
<li class="toctree-l1"><a class="reference internal" href="associativity.html">18. Associativity</a></li>
<li class="toctree-l1"><a class="reference internal" href="statements.html">19. Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="type-inference.html">20. Type inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="type-checking.html">21. Type checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="floating-point-types.html">22. Floating-point types</a></li>
<li class="toctree-l1"><a class="reference internal" href="enumeration-types.html">23. Enumeration types</a></li>
<li class="toctree-l1"><a class="reference internal" href="selection-statements.html">24. Selection statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="selection-expressions.html">25. Selection expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="iteration.html">26. Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="arrays.html">27. Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference-types.html">28. Reference types</a></li>
<li class="toctree-l1"><a class="reference internal" href="value-types.html">29. Value types</a></li>
<li class="toctree-l1"><a class="reference internal" href="local-functions.html">30. Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="recursion.html">31. Recursion</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects.html">32. Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">33. Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="access-modifiers.html">34. Access modifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="fields.html">35. Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="instance-methods.html">36. Instance methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="properties.html">37. Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructors.html">38. Constructors</a></li>
<li class="toctree-l1"><a class="reference internal" href="static-classes.html">39. Static classes (Modules)</a></li>
<li class="toctree-l1"><a class="reference internal" href="static-methods.html">40. Static methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="static-fields.html">41. Static fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="static-constructors.html">42. Static constructors</a></li>
<li class="toctree-l1"><a class="reference internal" href="extension-methods.html">43. Extension methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="object-composition.html">44. Object composition</a></li>
<li class="toctree-l1"><a class="reference internal" href="concrete-constructed-object-composition.html">45. Concrete constructed object composition</a></li>
<li class="toctree-l1"><a class="reference internal" href="concrete-injected-object-composition.html">46. Concrete injected object composition</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">47. Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="subtype-polymorphism.html">48. Subtype polymorphism</a></li>
<li class="toctree-l1"><a class="reference internal" href="inheritance.html">49. Inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced-access-modifiers.html">50. Advanced access modifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="abstract-classes.html">51. Abstract classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="object-type-conversions.html">52. Type conversions (of objects)</a></li>
<li class="toctree-l1"><a class="reference internal" href="abstract-constructed-object-composition.html">53. Abstract constructed object composition</a></li>
<li class="toctree-l1"><a class="reference internal" href="abstract-injected-object-composition.html">54. Abstract injected object composition</a></li>
<li class="toctree-l1"><a class="reference internal" href="variance.html">55. Variance</a></li>
<li class="toctree-l1"><a class="reference internal" href="liskov-substitution-principle.html">56. Liskov substitution principle</a></li>
<li class="toctree-l1"><a class="reference internal" href="generics.html">57. Generics</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-type-parameters.html">58. Generic type parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-types.html">59. Generic types</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-methods.html">60. Generic methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="type-parameter-constraints.html">61. Type parameter constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="variant-generic-interfaces.html">62. Variant generic interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="design-principles.html">63. Design principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="types-over-tests.html">64. Types over tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="single-responsibility-principle.html">65. Single responsibility principle</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface-segregation-principle.html">66. Interface segregation principle</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep-classes.html">67. Deep classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="define-errors-out-of-existence.html">68. Define errors out of existence</a></li>
<li class="toctree-l1"><a class="reference internal" href="open-closed-principle.html">69. Open-closed principle</a></li>
<li class="toctree-l1"><a class="reference internal" href="dependency-inversion-principle.html">70. Dependency inversion principle</a></li>
<li class="toctree-l1"><a class="reference internal" href="composition-over-inheritance.html">71. Composition over inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="design-patterns.html">72. Design patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="strategy-pattern.html">73. Strategy pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="null-object-pattern.html">74. Null object pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="bridge-pattern.html">75. Bridge pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="delegates.html">76. Delegates</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">77. Observer pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">78. Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="adapter-pattern.html">79. Adapter pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="factory-method-pattern.html">80. Factory method pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="composite-pattern.html">81. Composite pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="state-pattern.html">82. State pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="iterator-pattern.html">83. Iterator pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="visitor-pattern.html">84. Visitor pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="pattern-matching.html">85. Pattern matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambdas.html">86. Lambdas</a></li>
<li class="toctree-l1"><a class="reference internal" href="linq.html">87. LINQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="abstraction.html">88. Abstraction / Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="indirection.html">89. Indirection</a></li>
<li class="toctree-l1"><a class="reference internal" href="business-logic.html">90. Business logic</a></li>
<li class="toctree-l1"><a class="reference internal" href="business-objects.html">91. Business objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">92. Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="reading.html">93. Suggested reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">94. Bibliography</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="observer-pattern">
<h1><span class="section-number">77. </span>Observer pattern<a class="headerlink" href="#observer-pattern" title="Permalink to this heading">#</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Work in progress.</p>
</div>
<section id="definition">
<h2><span class="section-number">77.1. </span>Definition<a class="headerlink" href="#definition" title="Permalink to this heading">#</a></h2>
<p>The definition of the observer pattern from the classic design patterns book <span id="id1">Gamma <em>et al.</em> [<a class="reference internal" href="bibliography.html#id16" title="Erich Gamma, Richard Helm, Ralph Johnson, Ralph E. Johnson, and John Vlissides. Design Patterns: Elements of Reusable Object-Oriented Software. Addison-Wesley professional computing series. Addison-Wesley, 1995. ISBN 9783827330437. URL: http://amazon.christopherokhravi.com?id=design-patterns.">1995</a>]</span> is as follows:</p>
<blockquote class="epigraph">
<div><p>Define a one-to-many dependency between objects so that when one object changes state, all its dependents are notified and updated automatically.</p>
<p class="attribution">—<span id="id2">Gamma <em>et al.</em> [<a class="reference internal" href="bibliography.html#id16" title="Erich Gamma, Richard Helm, Ralph Johnson, Ralph E. Johnson, and John Vlissides. Design Patterns: Elements of Reusable Object-Oriented Software. Addison-Wesley professional computing series. Addison-Wesley, 1995. ISBN 9783827330437. URL: http://amazon.christopherokhravi.com?id=design-patterns.">1995</a>]</span></p>
</div></blockquote>
<figure class="align-default" id="id3">
<img alt="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a8/Observer_w_update.svg/1280px-Observer_w_update.svg.png" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a8/Observer_w_update.svg/1280px-Observer_w_update.svg.png" />
<figcaption>
<p><span class="caption-number">Fig. 77.1 </span><span class="caption-text">UML class diagram of observer pattern.
<em>[Image will be replaced soon]</em> [<a class="reference external" href="https://en.wikipedia.org/wiki/Observer_pattern#/media/File:Observer_w_update.svg">Image source</a>]</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Observer pattern is in a sense analogous to using <a class="reference internal" href="events.html"><span class="doc std std-doc">events</span></a> together with <a class="reference internal" href="delegates.html"><span class="doc std std-doc">delegates</span></a>.
The object that emits events is the observable, and the delegates are the observers.
We’ll talk more about this when we get to the chapter on <a class="reference internal" href="events.html"><span class="doc std std-doc">events</span></a>.</p>
</section>
<section id="examples">
<h2><span class="section-number">77.2. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h2>
<section id="observable-ciphers">
<h3><span class="section-number">77.2.1. </span>Observable ciphers<a class="headerlink" href="#observable-ciphers" title="Permalink to this heading">#</a></h3>
<p>Suppose that we’ve defined a cipher that takes a really long time to execute.
I let the cipher run on my machine over the night and when it’s completed I want to write the resulting output to screen <em>and</em> to a file.</p>
<p>While we could certainly do this by simply taking the output from the encode method and writing it to file and to screen.
However, we could also think about this problem in terms of events and notifications.
We want a notification from a cipher when the encoding is completed so that we can do whatever it is we want to do with the output.</p>
<p>Let’s try to solve this using the observer pattern.
Assume that we’ve got our good old <code class="docutils literal notranslate"><span class="pre">ICipher&lt;TIn,TOut&gt;</span></code> interface.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">ICipher</span><span class="o">&lt;</span><span class="n">TIn</span><span class="p">,</span><span class="n">TOut</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">TOut</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="n">TIn</span><span class="w"> </span><span class="n">input</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div>
    <div id='dotnet-interactive-this-cell-4339.Microsoft.DotNet.Interactive.Http.HttpPort' style='display: none'>
        The below script needs to be able to find the current output cell; this is an easy method to get it.
    </div>
    <script type='text/javascript'>
async function probeAddresses(probingAddresses) {
    function timeout(ms, promise) {
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                reject(new Error('timeout'))
            }, ms)
            promise.then(resolve, reject)
        })
    }

    if (Array.isArray(probingAddresses)) {
        for (let i = 0; i < probingAddresses.length; i++) {

            let rootUrl = probingAddresses[i];

            if (!rootUrl.endsWith('/')) {
                rootUrl = `${rootUrl}/`;
            }

            try {
                let response = await timeout(1000, fetch(`${rootUrl}discovery`, {
                    method: 'POST',
                    cache: 'no-cache',
                    mode: 'cors',
                    timeout: 1000,
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: probingAddresses[i]
                }));

                if (response.status == 200) {
                    return rootUrl;
                }
            }
            catch (e) { }
        }
    }
}

function loadDotnetInteractiveApi() {
    probeAddresses(["http://10.1.0.162:2048/", "http://127.0.0.1:2048/"])
        .then((root) => {
        // use probing to find host url and api resources
        // load interactive helpers and language services
        let dotnetInteractiveRequire = require.config({
        context: '4339.Microsoft.DotNet.Interactive.Http.HttpPort',
                paths:
            {
                'dotnet-interactive': `${root}resources`
                }
        }) || require;

            window.dotnetInteractiveRequire = dotnetInteractiveRequire;

            window.configureRequireFromExtension = function(extensionName, extensionCacheBuster) {
                let paths = {};
                paths[extensionName] = `${root}extensions/${extensionName}/resources/`;
                
                let internalRequire = require.config({
                    context: extensionCacheBuster,
                    paths: paths,
                    urlArgs: `cacheBuster=${extensionCacheBuster}`
                    }) || require;

                return internalRequire
            };
        
            dotnetInteractiveRequire([
                    'dotnet-interactive/dotnet-interactive'
                ],
                function (dotnet) {
                    dotnet.init(window);
                },
                function (error) {
                    console.log(error);
                }
            );
        })
        .catch(error => {console.log(error);});
    }

// ensure `require` is available globally
if ((typeof(require) !==  typeof(Function)) || (typeof(require.config) !== typeof(Function))) {
    let require_script = document.createElement('script');
    require_script.setAttribute('src', 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js');
    require_script.setAttribute('type', 'text/javascript');
    
    
    require_script.onload = function() {
        loadDotnetInteractiveApi();
    };

    document.getElementsByTagName('head')[0].appendChild(require_script);
}
else {
    loadDotnetInteractiveApi();
}

    </script>
</div></div></div>
</div>
<p>Let’s then introduce interfaces for the idea of being an observer and that of being an observable.</p>
<p>Our observers are simply required to implement a method called <code class="docutils literal notranslate"><span class="pre">Update</span></code> which takes two strings as arguments.
This method will be called on all observers whenever the observable that they observe have completed its encoding.
The first string parameter represents the input value that was sent to the Encode method and the second represents the output value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">ICipherObserver</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>What about the observable cipher?
What does its interface look like?
Well, at the very least, we must be able to register observers to it.
Let’s call the method <code class="docutils literal notranslate"><span class="pre">Add</span></code> and let’s stop there for now.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">IObservableCipher</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">void</span><span class="w"> </span><span class="nf">Add</span><span class="w"> </span><span class="p">(</span><span class="n">ICipherObserver</span><span class="w"> </span><span class="n">observer</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>So what might observers look like?
Remember what we said that we wanted to do?
We wanted to write the result of the encoding both to screen and to file.
Let’s first build an observer that writes to screen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CipherViewer</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICipherObserver</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="p">)</span>
<span class="w">    </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&quot;\&quot;{input}\&quot; was translated into \&quot;{output}\&quot;&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s now implement an observer that writes to file.
But, since we don’t actually care about file writing in this example, let’s just wave our hands and pretend that it writes to file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CipherWriter</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICipherObserver</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="p">)</span>
<span class="w">    </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Writing encoded data to file...&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>At least we’ve got two observers now.
But what about an observable?
Our observers don’t yet have anything to observe.
Let’s write an observable cipher.
For the purposes of this example it doesn’t at all matter what the encode method of the cipher does.
For this reason we’ll let the cipher behave like the identity cipher.
Meaning that it returns whatever input we give it back as output.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ObservableCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICipher</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="kt">string</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ICipherObserver</span><span class="o">&gt;</span><span class="w"> </span><span class="n">observers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ICipherObserver</span><span class="o">&gt;</span><span class="p">();</span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Add</span><span class="w"> </span><span class="p">(</span><span class="n">ICipherObserver</span><span class="w"> </span><span class="n">observer</span><span class="p">)</span>
<span class="w">    </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">observers</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">.</span><span class="n">Sleep</span><span class="p">(</span><span class="m">2000</span><span class="p">);</span><span class="w"> </span><span class="c1">// Delay to simulate slow cipher.</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">;</span><span class="w"> </span><span class="c1">// Encode logic here.</span>
<span class="w">    </span><span class="n">notify</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">void</span><span class="w"> </span><span class="nf">notify</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">ICipherObserver</span><span class="w"> </span><span class="n">observer</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">observers</span><span class="p">)</span>
<span class="w">      </span><span class="n">observer</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s now see all this in action.
First we instantiate the observable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">ObservableCipher</span><span class="w"> </span><span class="n">observable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObservableCipher</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<p>Then we register any number of observables that we want.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">observable</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CipherViewer</span><span class="p">());</span>
<span class="n">observable</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CipherWriter</span><span class="p">());</span>
</pre></div>
</div>
</div>
</div>
<p>Then we simply call <code class="docutils literal notranslate"><span class="pre">Encode</span></code> on the observable cipher and watch as the observers get notified about the change and then go on to do their thing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">observable</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="s">&quot;foobar&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;foobar&quot; was translated into &quot;foobar&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing encoded data to file...
</pre></div>
</div>
</div>
</div>
<p>Notice how the <code class="docutils literal notranslate"><span class="pre">Update</span></code> method of both observers is executed.
Notice also how we don’t actually need to store the return value of the call to the method <code class="docutils literal notranslate"><span class="pre">Encode</span></code>.</p>
</section>
<section id="generic-observable-ciphers">
<span id="observer-pattern-generic-observable-ciphers"></span><h3><span class="section-number">77.2.2. </span>Generic observable ciphers<a class="headerlink" href="#generic-observable-ciphers" title="Permalink to this heading">#</a></h3>
<p>As you might have suspected however, most of the code in <code class="docutils literal notranslate"><span class="pre">ObservableCipher</span></code> will have to be duplicated as soon as we want to be able to create a new observable cipher.
Such as an observable Caesar cipher, or observable Robbers cipher, etc.
Also, why did we couple to ciphers that take and return strings?
What if we want to observe ciphers that work with single characters?</p>
<p>Can we get rid of that duplicated code by means of inheritance?
Sure, we might be able to do that.
But remember the idea of favoring <a class="reference internal" href="composition-over-inheritance.html"><span class="doc std std-doc">composition over inheritance</span></a>?
Remember the <a class="reference internal" href="strategy-pattern.html"><span class="doc std std-doc">strategy pattern</span></a>?
Remember <a class="reference internal" href="abstract-injected-object-composition.html"><span class="doc std std-doc">abstract injected object composition</span></a>?
Let’s use composition and separate the responsibility of being observable from that of translating some input to some output.</p>
<p>Our ciphers of type <code class="docutils literal notranslate"><span class="pre">ICipher&lt;TIn,TOut&gt;</span></code> are already very good at translating from input to output so let’s let them keep doing that.
Let’s instead write a new observable cipher class that’s generic and that has a cipher.
How does the cipher end up in the observable cipher?
Good old <a class="reference internal" href="abstract-injected-object-composition.html"><span class="doc std std-doc">abstract injected object composition</span></a>.</p>
<p>But let’s start by generalizing the observer interface.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">ICipherObserver</span><span class="o">&lt;</span><span class="n">TIn</span><span class="p">,</span><span class="n">TOut</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="w"> </span><span class="p">(</span><span class="n">TIn</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">TOut</span><span class="w"> </span><span class="n">output</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Most code will essentially be the same as before.
We’re mostly just replacing actual types with type parameters.</p>
<p>Of course our cipher observers presume that the cipher that they are observing will generate strings as output, based on strings as input so we’ll have to say that they implement the interface <code class="docutils literal notranslate"><span class="pre">ICipherObserver&lt;string,string&gt;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CipherViewer</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICipherObserver</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="kt">string</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="p">)</span>
<span class="w">    </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&quot;\&quot;{input}\&quot; was translated into \&quot;{output}\&quot;&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CipherWriter</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICipherObserver</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="kt">string</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="p">)</span>
<span class="w">    </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Writing encode data to file...&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>We’re now ready to generalize the observable cipher.
Notice how we’re now both generalizing the observable cipher so that it uses two type parameters, but also how we’re now accepting another cipher in the constructor.
When the encode method of the observable cipher is called, it delegates to the composed cipher and notifies all observers.
We’ve now separated the two concerns.
The observable cipher delegates the actual encoding to the composed cipher, but is itself responsible for notifying the observers when the encoding is completed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ObservableCipher</span><span class="o">&lt;</span><span class="n">TIn</span><span class="p">,</span><span class="n">TOut</span><span class="o">&gt;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICipher</span><span class="o">&lt;</span><span class="n">TIn</span><span class="p">,</span><span class="n">TOut</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">ICipher</span><span class="o">&lt;</span><span class="n">TIn</span><span class="p">,</span><span class="n">TOut</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cipher</span><span class="p">;</span>
<span class="w">  </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ICipherObserver</span><span class="o">&lt;</span><span class="n">TIn</span><span class="p">,</span><span class="n">TOut</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">observers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ICipherObserver</span><span class="o">&lt;</span><span class="n">TIn</span><span class="p">,</span><span class="n">TOut</span><span class="o">&gt;&gt;</span><span class="p">();</span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="nf">ObservableCipher</span><span class="w"> </span><span class="p">(</span><span class="n">ICipher</span><span class="o">&lt;</span><span class="n">TIn</span><span class="p">,</span><span class="n">TOut</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cipher</span><span class="p">)</span>
<span class="w">    </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipher</span><span class="p">;</span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Add</span><span class="w"> </span><span class="p">(</span><span class="n">ICipherObserver</span><span class="o">&lt;</span><span class="n">TIn</span><span class="p">,</span><span class="n">TOut</span><span class="o">&gt;</span><span class="w"> </span><span class="n">observer</span><span class="p">)</span>
<span class="w">    </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">observers</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>

<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="n">TOut</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="n">TIn</span><span class="w"> </span><span class="n">input</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">TOut</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="n">input</span><span class="p">);</span><span class="w">  </span><span class="c1">// Delegate the encoding of input.</span>
<span class="w">    </span><span class="n">notify</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">);</span><span class="w">               </span><span class="c1">// Notify all observers.</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">void</span><span class="w"> </span><span class="nf">notify</span><span class="w"> </span><span class="p">(</span><span class="n">TIn</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">TOut</span><span class="w"> </span><span class="n">output</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">ICipherObserver</span><span class="o">&lt;</span><span class="n">TIn</span><span class="p">,</span><span class="n">TOut</span><span class="o">&gt;</span><span class="w"> </span><span class="n">observer</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">observers</span><span class="p">)</span>
<span class="w">      </span><span class="n">observer</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s bring back the Reverse cipher so that we can run an example with a cipher that’s more interesting than the identity cipher.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ReverseCipher</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICipher</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="kt">string</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">Encode</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">input</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="n">input</span><span class="p">.</span><span class="n">Length</span><span class="o">-</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&gt;=</span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span>
<span class="w">      </span><span class="n">output</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">output</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Ok, let’s now run it to make sure that it works.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Instantiate observable cipher.</span>
<span class="n">ObservableCipher</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">observable</span>
<span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObservableCipher</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="kt">string</span><span class="o">&gt;</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ReverseCipher</span><span class="p">());</span>

<span class="c1">// Instantiate and add observables.</span>
<span class="n">observable</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CipherViewer</span><span class="p">());</span>
<span class="n">observable</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CipherWriter</span><span class="p">());</span>

<span class="c1">// Run the encoding on the observable.</span>
<span class="n">observable</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;abc&quot; was translated into &quot;cba&quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing encode data to file...
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="video">
<h2><span class="section-number">77.3. </span>Video<a class="headerlink" href="#video" title="Permalink to this heading">#</a></h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_BpmfnqjgzQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</section>
<section id="exercises">
<h2><span class="section-number">77.4. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<div class="exercise admonition" id="chapters/observer-pattern-exercise-0">

<p class="admonition-title"><span class="caption-number">Exercise 77.1 </span></p>
<section id="exercise-content">
<p>What is the observer pattern?
Explain it in your own words and by using an example.</p>
</section>
</div>
<div class="exercise admonition" id="chapters/observer-pattern-exercise-1">

<p class="admonition-title"><span class="caption-number">Exercise 77.2 </span></p>
<section id="exercise-content">
<p>Come up with your own example that meaningfully uses the observer pattern and implement it in code.</p>
</section>
</div>
<div class="exercise admonition" id="chapters/observer-pattern-exercise-2">

<p class="admonition-title"><span class="caption-number">Exercise 77.3 </span></p>
<section id="exercise-content">
<p>What do we mean when we say that observer pattern replaces “polling” with “pushing”, from the perspective of the observer?</p>
</section>
</div>
<div class="exercise admonition" id="chapters/observer-pattern-exercise-3">

<p class="admonition-title"><span class="caption-number">Exercise 77.4 </span></p>
<section id="exercise-content">
<p>How are the <a class="reference internal" href="maintainability.html#maintainability-characteristics"><span class="std std-ref">maintainability characteristics</span></a> affected when using the observer pattern?</p>
</section>
</div>
<div class="exercise admonition" id="ex:observer-pattern:cipher-log">

<p class="admonition-title"><span class="caption-number">Exercise 77.5 </span></p>
<section id="exercise-content">
<p>Write a class called <code class="docutils literal notranslate"><span class="pre">CipherLog</span></code> that implements the interface <code class="docutils literal notranslate"><span class="pre">ICipherObserver&lt;string,string&gt;</span></code> from this chapter.
The observer should log the input and output of all completed encode operations.
You can choose to log the translations any way you like, but I would suggest a simple list of <code class="docutils literal notranslate"><span class="pre">(string,string)</span></code> tuples.
It should also expose a method with the signature <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">ToTSV()</span></code> or <code class="docutils literal notranslate"><span class="pre">string</span> <span class="pre">ToCSV()</span></code> that returns a <a class="reference external" href="https://en.wikipedia.org/wiki/Comma-separated_values">CSV</a> or <a class="reference external" href="https://en.wikipedia.org/wiki/Tab-separated_values">TSV</a> formatted string of the full log.</p>
<p>The completed class should behave like in the example below.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Instantiate observable cipher.</span>
<span class="n">ObservableCipher</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="n">observable</span>
<span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObservableCipher</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="kt">string</span><span class="o">&gt;</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ReverseCipher</span><span class="p">());</span>

<span class="c1">// Instantiate log that will observe.</span>
<span class="n">CipherLog</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CipherLog</span><span class="p">();</span>

<span class="c1">// Add the log as an observable.</span>
<span class="n">observable</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">log</span><span class="p">);</span>

<span class="c1">// Run the encoding on the observable.</span>
<span class="n">observable</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">);</span>
<span class="n">observable</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="s">&quot;ABC&quot;</span><span class="p">);</span>
<span class="n">observable</span><span class="p">.</span><span class="n">Encode</span><span class="p">(</span><span class="s">&quot;123&quot;</span><span class="p">);</span>

<span class="c1">// Print the log.</span>
<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">log</span><span class="p">.</span><span class="n">ToTSV</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INPUT	OUTPUT
abc	cba
ABC	CBA
123	321
</pre></div>
</div>
</div>
</div>
</section>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-csharp"
        },
        kernelOptions: {
            name: ".net-csharp",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-csharp'</script>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="events.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">78. </span>Events</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="delegates.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">76. </span>Delegates</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">77. Observer pattern</a><ul>
<li><a class="reference internal" href="#definition">77.1. Definition</a></li>
<li><a class="reference internal" href="#examples">77.2. Examples</a><ul>
<li><a class="reference internal" href="#observable-ciphers">77.2.1. Observable ciphers</a></li>
<li><a class="reference internal" href="#generic-observable-ciphers">77.2.2. Generic observable ciphers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#video">77.3. Video</a></li>
<li><a class="reference internal" href="#exercises">77.4. Exercises</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    </body>
</html>